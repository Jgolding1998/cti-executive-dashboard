<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTI Gas - Executive Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #1e3a5f;
            --secondary: #3d5a80;
            --accent: #ee6c4d;
            --success: #06d6a0;
            --warning: #ffd166;
            --danger: #ef476f;
            --bg-dark: #0d1b2a;
            --bg-card: #1b2838;
            --text-primary: #ffffff;
            --text-secondary: #98c1d9;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%);
            color: var(--text-primary);
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header h1 { font-size: 24px; font-weight: 300; }
        .header h1 span { font-weight: 700; color: var(--accent); }
        .header .nav { display: flex; gap: 15px; flex-wrap: wrap; }
        .header .nav a {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s;
        }
        .header .nav a:hover, .header .nav a.active {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        .timestamp { color: var(--text-secondary); font-size: 12px; }
        .page { display: none; padding: 25px; max-width: 1900px; margin: 0 auto; }
        .page.active { display: block; }
        .dashboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .card {
            background: var(--bg-card);
            border-radius: 14px;
            padding: 20px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .card.span-2 { grid-column: span 2; }
        .card.span-3 { grid-column: span 3; }
        .card.span-4 { grid-column: span 4; }
        .card-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-title::before {
            content: '';
            width: 3px;
            height: 16px;
            background: var(--accent);
            border-radius: 2px;
        }
        .metric {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #fff, var(--text-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .metric.green { background: linear-gradient(135deg, var(--success), #00ff88); -webkit-background-clip: text; background-clip: text; }
        .metric.small { font-size: 26px; }
        .metric-label { font-size: 12px; color: var(--text-secondary); margin-top: 4px; }
        .breakdown { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .breakdown-item {
            text-align: center;
            padding: 12px 8px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            border-left: 3px solid;
            overflow: hidden;
            min-width: 0;
        }
        .breakdown-item.product { border-color: #4ecdc4; }
        .breakdown-item.service { border-color: #ff6b6b; }
        .breakdown-item.freight { border-color: #feca57; }
        .breakdown-item.misc { border-color: #a29bfe; }
        .breakdown-item .amount { font-size: 16px; font-weight: 600; }
        .breakdown-item .label { font-size: 10px; text-transform: uppercase; color: var(--text-secondary); margin-top: 3px; }
        .chart-container { position: relative; height: 280px; margin-top: 10px; }
        .chart-container.tall { height: 350px; }
        #shippingMap { height: 320px; border-radius: 10px; margin-top: 10px; }
        .top-list { margin-top: 10px; max-height: 350px; overflow-y: auto; }
        .top-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            margin-bottom: 6px;
        }
        .top-item:hover { background: rgba(255,255,255,0.06); }
        .top-item .rank {
            width: 24px;
            height: 24px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 700;
            margin-right: 12px;
            flex-shrink: 0;
        }
        .top-item .rank.gold { background: linear-gradient(135deg, #ffd700, #ff8c00); }
        .top-item .rank.silver { background: linear-gradient(135deg, #c0c0c0, #808080); }
        .top-item .rank.bronze { background: linear-gradient(135deg, #cd7f32, #8b4513); }
        .top-item .name { flex: 1; font-size: 13px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .top-item .amount { font-weight: 600; color: var(--success); font-size: 13px; white-space: nowrap; }
        .top-item .meta { font-size: 11px; color: var(--text-secondary); margin-left: 10px; white-space: nowrap; }
        .cash-flow-week {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
        }
        .cash-flow-week .week-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .cash-flow-week .week-label { font-weight: 600; font-size: 14px; }
        .cash-flow-week .week-total { font-size: 22px; font-weight: 700; color: var(--success); }
        .cash-flow-week .confidence {
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
        }
        .cash-flow-week .confidence.high { background: rgba(6,214,160,0.2); color: var(--success); }
        .cash-flow-week .confidence.medium { background: rgba(255,209,102,0.2); color: var(--warning); }
        .cash-flow-week .confidence.low { background: rgba(239,71,111,0.2); color: var(--danger); }
        .cash-flow-week .day-breakdown { display: flex; gap: 8px; }
        .cash-flow-week .day {
            flex: 1;
            text-align: center;
            padding: 8px 4px;
            background: rgba(255,255,255,0.03);
            border-radius: 6px;
            font-size: 11px;
        }
        .cash-flow-week .day.actual { border-bottom: 2px solid var(--success); }
        .cash-flow-week .day.predicted { border-bottom: 2px solid var(--warning); opacity: 0.8; }
        .cash-flow-week .day.today { border-bottom: 2px solid var(--accent); }
        .cash-flow-week .day .day-name { color: var(--text-secondary); margin-bottom: 4px; }
        .cash-flow-week .day .day-amount { font-weight: 600; }
        .ar-aging { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; margin-top: 10px; }
        .ar-bucket {
            text-align: center;
            padding: 10px 5px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            overflow: hidden;
        }
        .ar-bucket .amount { font-size: 13px; font-weight: 700; white-space: nowrap; overflow: visible; }
        .ar-bucket .label { font-size: 10px; color: var(--text-secondary); margin-top: 4px; }
        .ar-bucket.current .amount { color: var(--success); }
        .ar-bucket.days30 .amount { color: #4ecdc4; }
        .ar-bucket.days60 .amount { color: var(--warning); }
        .ar-bucket.days90 .amount { color: #ff9f43; }
        .ar-bucket.over90 .amount { color: var(--danger); }
        .kpi-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }
        .kpi-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 18px;
            text-align: center;
        }
        .kpi-card .value { font-size: 28px; font-weight: 700; }
        .kpi-card .label { font-size: 11px; color: var(--text-secondary); margin-top: 5px; text-transform: uppercase; }
        .tab-buttons { display: flex; gap: 8px; margin-bottom: 12px; }
        .tab-btn {
            padding: 6px 14px;
            background: rgba(255,255,255,0.05);
            border: none;
            border-radius: 15px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
        }
        .tab-btn.active { background: var(--accent); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .salesperson-card {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .salesperson-card .name { font-weight: 600; font-size: 16px; }
        .salesperson-card .amount { font-size: 24px; font-weight: 700; color: var(--success); }
        .salesperson-card .invoices { font-size: 12px; color: var(--text-secondary); }
        @media (max-width: 1200px) {
            .card.span-2, .card.span-3 { grid-column: span 1; }
            .breakdown { grid-template-columns: repeat(2, 1fr); }
            .kpi-row { grid-template-columns: repeat(2, 1fr); }
            .ar-aging { grid-template-columns: repeat(5, 1fr); gap: 4px; }
            .ar-bucket { padding: 8px 3px; }
            .ar-bucket .amount { font-size: 12px; }
        }
        /* Drill-down Modal */
        .drilldown-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        .drilldown-overlay.active { display: flex; align-items: center; justify-content: center; }
        .drilldown-modal {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 0;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            animation: slideUp 0.2s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .drilldown-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.03);
        }
        .drilldown-header h3 { margin: 0; font-size: 18px; font-weight: 600; }
        .drilldown-header .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
            transition: color 0.2s;
        }
        .drilldown-header .close-btn:hover { color: white; }
        .drilldown-body {
            padding: 25px;
            overflow-y: auto;
            max-height: calc(80vh - 80px);
        }
        .drilldown-total {
            font-size: 36px;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 20px;
        }
        .drilldown-section {
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .drilldown-section h4 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin: 0 0 12px 0;
        }
        .drilldown-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .drilldown-row:last-child { border-bottom: none; }
        .drilldown-row .label { color: var(--text-secondary); }
        .drilldown-row .value { font-weight: 600; }
        .drilldown-row.product .value { color: #4ecdc4; }
        .drilldown-row.service .value { color: #ff6b6b; }
        .drilldown-row.freight .value { color: #feca57; }
        .drilldown-row.misc .value { color: #a29bfe; }
        .drilldown-row.total { font-weight: 700; padding-top: 12px; margin-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); }
        .drilldown-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 12px;
            background: rgba(255,255,255,0.02);
            border-radius: 6px;
            margin-bottom: 6px;
        }
        .drilldown-item:hover { background: rgba(255,255,255,0.05); }
        .drilldown-item .name { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .drilldown-item .amount { font-weight: 600; color: var(--success); margin-left: 15px; }
        .drilldown-item .meta { font-size: 11px; color: var(--text-secondary); margin-left: 10px; }
        .drilldown-pct {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            font-size: 11px;
            margin-left: 10px;
        }
        .clickable {
            cursor: pointer;
            transition: all 0.2s;
        }
        .clickable:hover { 
            transform: scale(1.02);
            filter: brightness(1.15);
        }
        .kpi-card:hover { 
            background: rgba(255,255,255,0.05);
            transform: translateY(-2px);
        }
        .breakdown-item.clickable:hover { background: rgba(255,255,255,0.08); }
        .ar-bucket.clickable:hover { background: rgba(255,255,255,0.08); }
        .top-item.clickable:hover { background: rgba(255,255,255,0.08); transform: translateX(3px); }
        .salesperson-card.clickable:hover { background: rgba(255,255,255,0.08); transform: translateX(3px); }
        .cash-flow-week.clickable:hover { background: rgba(255,255,255,0.06); }
        /* AR Details Table */
        .ar-table { width: 100%; border-collapse: collapse; font-size: 13px; }
        .ar-table th, .ar-table td { padding: 10px 12px; text-align: right; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .ar-table th { background: rgba(255,255,255,0.05); color: var(--text-secondary); font-weight: 600; text-transform: uppercase; font-size: 11px; }
        .ar-table th:first-child, .ar-table td:first-child { text-align: left; }
        .ar-table tr:hover { background: rgba(255,255,255,0.03); }
        .ar-table .total-row { font-weight: 700; background: rgba(255,255,255,0.05); }
        .ar-table .overdue { color: var(--danger); }
        .ar-table .current { color: var(--success); }
        
        /* AR Detail Grid */
        .ar-detail-grid { display: flex; flex-direction: column; gap: 8px; }
        .ar-detail-row { display: grid; grid-template-columns: 1fr 1fr 1fr; padding: 12px 15px; background: rgba(255,255,255,0.03); border-radius: 8px; }
        .ar-detail-row.header { background: rgba(255,255,255,0.08); font-weight: 600; color: var(--text-secondary); font-size: 11px; text-transform: uppercase; }
        .ar-detail-row span:not(:first-child) { text-align: right; }
        .ar-detail-row.current span:nth-child(2) { color: var(--success); font-weight: 600; }
        .ar-detail-row.days30 span:nth-child(2) { color: #4ecdc4; font-weight: 600; }
        .ar-detail-row.days60 span:nth-child(2) { color: var(--warning); font-weight: 600; }
        .ar-detail-row.days90 span:nth-child(2) { color: #ff9f43; font-weight: 600; }
        .ar-detail-row.over90 span:nth-child(2) { color: var(--danger); font-weight: 600; }
        .ar-detail-row.total { background: rgba(255,255,255,0.08); font-weight: 700; }
        
        /* P&L Grid */
        .pnl-grid { display: flex; flex-direction: column; gap: 15px; }
        .pnl-section { background: rgba(255,255,255,0.03); border-radius: 10px; overflow: hidden; }
        .pnl-header { padding: 12px 15px; background: rgba(255,255,255,0.05); font-weight: 600; color: var(--text-secondary); text-transform: uppercase; font-size: 12px; }
        .pnl-row { display: flex; justify-content: space-between; padding: 12px 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .pnl-row:last-child { border-bottom: none; }
        .pnl-row.total { background: rgba(255,255,255,0.05); }
        .pnl-row .amount { font-weight: 600; color: var(--success); }
    </style>
</head>
<body>
    <div class="header">
        <h1><span>CTI</span> Executive Dashboard</h1>
        <div class="nav">
            <a href="#" class="active" onclick="showPage('overview')">Overview</a>
            <a href="#" onclick="showPage('sales')">Sales Team</a>
            <a href="#" onclick="showPage('ar')">AR Aging</a>
            <a href="#" onclick="showPage('pnl')">P&L</a>
            <a href="#" onclick="showPage('cashflow')">Cash Flow</a>
            <a href="#" onclick="showPage('customers')">Customers</a>
            <a href="#" onclick="showPage('products')">Products</a>
            <a href="#" onclick="showPage('geography')">Geography</a>
        </div>
        <div style="display: flex; align-items: center; gap: 15px;">
            <div class="timestamp" id="timestamp">Loading...</div>
            <div style="font-size: 11px; color: var(--text-secondary); background: rgba(255,255,255,0.1); padding: 4px 10px; border-radius: 12px;">ðŸ’¡ Click any number for details</div>
        </div>
    </div>

    <!-- OVERVIEW PAGE -->
    <div id="overview" class="page active">
        <div class="kpi-row">
            <div class="kpi-card" onclick="showDrilldown('yesterday')" style="cursor:pointer;">
                <div class="value clickable" style="color: var(--success);" id="kpiYesterday">$0</div>
                <div class="label">Yesterday's Sales</div>
            </div>
            <div class="kpi-card" onclick="showDrilldown('mtd')" style="cursor:pointer;">
                <div class="value clickable" style="color: #4ecdc4;" id="kpiMTD">$0</div>
                <div class="label">Month-to-Date</div>
            </div>
            <div class="kpi-card" onclick="showDrilldown('ytd')" style="cursor:pointer;">
                <div class="value clickable" style="color: var(--warning);" id="kpiYTD">$0</div>
                <div class="label">Year-to-Date</div>
            </div>
            <div class="kpi-card" onclick="showDrilldown('ar')" style="cursor:pointer;">
                <div class="value clickable" style="color: var(--accent);" id="kpiAR">$0</div>
                <div class="label">AR Outstanding</div>
            </div>
        </div>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">60-Day Sales Trend</div>
                <div class="chart-container tall"><canvas id="trendChart"></canvas></div>
            </div>
            <div class="card">
                <div class="card-title">Yesterday's Breakdown</div>
                <div class="metric clickable" id="yesterdayTotal" onclick="showDrilldown('yesterday')" style="cursor:pointer;">$0</div>
                <div class="metric-label" id="yesterdayDate">--</div>
                <div class="breakdown">
                    <div class="breakdown-item product clickable" id="yProductCard"><div class="amount" id="yProduct">$0</div><div class="label">Product</div></div>
                    <div class="breakdown-item service clickable" id="yServiceCard"><div class="amount" id="yService">$0</div><div class="label">Service</div></div>
                    <div class="breakdown-item freight clickable" id="yFreightCard"><div class="amount" id="yFreight">$0</div><div class="label">Freight</div></div>
                    <div class="breakdown-item misc clickable" id="yMiscCard"><div class="amount" id="yMisc">$0</div><div class="label">Misc</div></div>
                </div>
            </div>
            <div class="card">
                <div class="card-title">MTD Sales Mix</div>
                <div class="chart-container"><canvas id="categoryPie"></canvas></div>
            </div>
            <div class="card" style="overflow: hidden;">
                <div class="card-title">Daily Averages</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div class="clickable" style="text-align: center; padding: 15px 8px; background: rgba(255,255,255,0.03); border-radius: 10px; overflow: hidden;" onclick="showDrilldown('mtd')">
                        <div style="font-size: 22px; font-weight: 700; color: var(--success);" id="mtdAvg">$0</div>
                        <div class="metric-label">MTD Daily Avg</div>
                    </div>
                    <div class="clickable" style="text-align: center; padding: 15px 8px; background: rgba(255,255,255,0.03); border-radius: 10px; overflow: hidden;" onclick="showDrilldown('ytd')">
                        <div style="font-size: 22px; font-weight: 700; color: var(--text-secondary);" id="ytdAvg">$0</div>
                        <div class="metric-label">YTD Daily Avg</div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div class="clickable" style="text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.03); border-radius: 10px;" onclick="showDrilldown('mtd')">
                        <div style="font-size: 18px; font-weight: 600;" id="mtdDays">0</div>
                        <div class="metric-label">MTD Business Days</div>
                    </div>
                    <div class="clickable" style="text-align: center; padding: 12px 8px; background: rgba(255,255,255,0.03); border-radius: 10px;" onclick="showDrilldown('ytd')">
                        <div style="font-size: 18px; font-weight: 600;" id="ytdDays">0</div>
                        <div class="metric-label">YTD Business Days</div>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-title">AR Aging</div>
                <div class="ar-aging">
                    <div class="ar-bucket current clickable" id="arCurrentCard" style="cursor:pointer;"><div class="amount" id="arCurrent">$0</div><div class="label">Current</div></div>
                    <div class="ar-bucket days30 clickable" id="ar30Card" style="cursor:pointer;"><div class="amount" id="ar30">$0</div><div class="label">1-30 Days</div></div>
                    <div class="ar-bucket days60 clickable" id="ar60Card" style="cursor:pointer;"><div class="amount" id="ar60">$0</div><div class="label">31-60 Days</div></div>
                    <div class="ar-bucket days90 clickable" id="ar90Card" style="cursor:pointer;"><div class="amount" id="ar90">$0</div><div class="label">61-90 Days</div></div>
                    <div class="ar-bucket over90 clickable" id="ar90plusCard" style="cursor:pointer;"><div class="amount" id="ar90plus">$0</div><div class="label">90+ Days</div></div>
                </div>
                <div class="chart-container" style="height: 180px;"><canvas id="arChart"></canvas></div>
            </div>
            <div class="card">
                <div class="card-title">Day of Week Performance</div>
                <div class="chart-container"><canvas id="dowChart"></canvas></div>
            </div>
            <div class="card">
                <div class="card-title">Top Customers (MTD)</div>
                <div class="top-list" id="topCustomersMTD"></div>
            </div>
            <div class="card">
                <div class="card-title">Top Products (MTD)</div>
                <div class="top-list" id="topProductsMTD"></div>
            </div>
        </div>
    </div>

    <!-- SALES TEAM PAGE (NEW) -->
    <div id="sales" class="page">
        <div class="kpi-row">
            <div class="kpi-card clickable" onclick="showDrilldown('yesterday')" style="cursor:pointer;">
                <div class="value" style="color: var(--success);" id="spYesterdayTotal">$0</div>
                <div class="label">Yesterday Total (All)</div>
            </div>
            <div class="kpi-card clickable" onclick="showDrilldown('mtd')" style="cursor:pointer;">
                <div class="value" style="color: #4ecdc4;" id="spMTDTotal">$0</div>
                <div class="label">MTD Total (All)</div>
            </div>
            <div class="kpi-card">
                <div class="value" style="color: var(--warning);" id="spTopPerformer">--</div>
                <div class="label">Top Performer MTD</div>
            </div>
            <div class="kpi-card">
                <div class="value" style="color: var(--accent);" id="spInvoiceCount">0</div>
                <div class="label">MTD Invoices</div>
            </div>
        </div>
        <!-- Service Team KPIs -->
        <div class="kpi-row" style="margin-top: 10px;">
            <div class="kpi-card" style="border-left: 3px solid #ff6b6b;">
                <div class="value" style="color: #ff6b6b;" id="svcMTDTotal">$0</div>
                <div class="label">Service Revenue MTD</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid #a29bfe;">
                <div class="value" style="color: #a29bfe;" id="svcAvgTicket">$0</div>
                <div class="label">Avg Service Call</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid var(--warning);">
                <div class="value" style="color: var(--warning);" id="svcStates">0</div>
                <div class="label">States Covered MTD</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid var(--success);">
                <div class="value" style="color: var(--success);" id="svcTopRep">--</div>
                <div class="label">Top Service Rep</div>
            </div>
        </div>
        
        <!-- Field Tech KPIs -->
        <div class="kpi-row" style="margin-top: 10px;">
            <div class="kpi-card" style="border-left: 3px solid #ff6b6b;">
                <div class="value" style="color: #ff6b6b;" id="ftTotalTechs">0</div>
                <div class="label">Active Field Techs</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid var(--success);">
                <div class="value" style="color: var(--success);" id="ftApptsMTD">0</div>
                <div class="label">Field Appointments MTD</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid #4ecdc4;">
                <div class="value" style="color: #4ecdc4;" id="ftStatesMTD">0</div>
                <div class="label">States Serviced MTD</div>
            </div>
            <div class="kpi-card" style="border-left: 3px solid var(--warning);">
                <div class="value" style="color: var(--warning);" id="ftTopTech">--</div>
                <div class="label">Top Field Tech</div>
            </div>
        </div>
        
        <!-- All Team Section -->
        <h3 style="color: var(--text-primary); margin: 20px 0 10px 0; padding-left: 10px; border-left: 4px solid var(--warning);">All Team Performance (with Roles)</h3>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">All Team - Month to Date</div>
                <div class="chart-container tall"><canvas id="allTeamBarChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">MTD Breakdown by Role</div>
                <div id="allTeamMTDList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
        
        <!-- Sales Reps Section -->
        <h3 style="color: var(--text-primary); margin: 20px 0 10px 0; padding-left: 10px; border-left: 4px solid var(--success);">Sales Reps</h3>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Sales Reps - Month to Date</div>
                <div class="chart-container tall"><canvas id="salespersonBarChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Sales Rep Performance</div>
                <div id="salespersonMTDList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
        
        <!-- Service Team Section (Scheduling/Support Staff) -->
        <h3 style="color: var(--text-primary); margin: 20px 0 10px 0; padding-left: 10px; border-left: 4px solid #4ecdc4;">Service Team (Scheduling & Support)</h3>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Service Team - Revenue by Territory</div>
                <div class="chart-container tall"><canvas id="serviceRepBarChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Service Team Performance</div>
                <div id="serviceRepMTDList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
        
        <!-- Field Technicians Section -->
        <h3 style="color: var(--text-primary); margin: 20px 0 10px 0; padding-left: 10px; border-left: 4px solid #ff6b6b;">Field Service Technicians</h3>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Field Technician Roster (from Salesforce)</div>
                <div id="fieldTechList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Service States Covered (MTD)</div>
                <div id="serviceStatesCovered" style="max-height: 400px; overflow-y: auto;"></div>
                <div style="margin-top: 15px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px; font-size: 12px; color: var(--text-secondary);">
                    <strong>Note:</strong> Field tech performance data requires Salesforce service dispatch integration. Currently showing roster from Salesforce. States covered are derived from service order shipping addresses.
                </div>
            </div>
        </div>
        
        <!-- Yesterday Section -->
        <h3 style="color: var(--text-primary); margin: 20px 0 10px 0; padding-left: 10px; border-left: 4px solid var(--accent);">Yesterday's Activity</h3>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Yesterday's Sales by Team Member</div>
                <div class="chart-container tall"><canvas id="salespersonYesterdayChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Yesterday Performance</div>
                <div id="salespersonYesterdayList" style="max-height: 400px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

    <!-- AR AGING PAGE -->
    <div id="ar" class="page">
        <div class="kpi-row">
            <div class="kpi-card clickable" onclick="showDrilldown('ar')" style="cursor:pointer;">
                <div class="value" style="color: var(--success);" id="arKpiTotal">$0</div>
                <div class="label">Total AR Outstanding</div>
            </div>
            <div class="kpi-card clickable" id="arKpiCurrentCard" style="cursor:pointer;">
                <div class="value" style="color: #4ecdc4;" id="arKpiCurrent">$0</div>
                <div class="label">Current (Not Due)</div>
            </div>
            <div class="kpi-card clickable" id="arKpiOverdueCard" style="cursor:pointer;">
                <div class="value" style="color: var(--warning);" id="arKpiOverdue">$0</div>
                <div class="label">Total Overdue</div>
            </div>
            <div class="kpi-card clickable" id="arKpi90PlusCard" style="cursor:pointer;">
                <div class="value" style="color: var(--danger);" id="arKpi90Plus">$0</div>
                <div class="label">90+ Days Overdue</div>
            </div>
        </div>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">AR Aging Breakdown</div>
                <div class="chart-container tall"><canvas id="arAgingDetailChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Aging Distribution</div>
                <div class="chart-container tall"><canvas id="arAgingPieChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">AR Aging Summary</div>
                <div style="padding: 15px;">
                    <div class="ar-detail-grid" id="arAgingGrid">
                        <div class="ar-detail-row header">
                            <span>Bucket</span>
                            <span>Amount</span>
                            <span>% of Total</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card span-2">
                <div class="card-title">Top 20 Customers by AR Balance</div>
                <div class="top-list" id="arTopCustomers" style="max-height: 500px;"></div>
            </div>
        </div>
        <div class="dashboard" style="margin-top: 20px;">
            <div class="card span-4">
                <div class="card-title">AR Aging Details by Customer</div>
                <div style="overflow-x: auto;">
                    <table class="ar-table" id="arCustomerTable">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Current</th>
                                <th>1-30 Days</th>
                                <th>31-60 Days</th>
                                <th>61-90 Days</th>
                                <th>90+ Days</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- P&L / INCOME STATEMENT PAGE -->
    <div id="pnl" class="page">
        <div class="kpi-row">
            <div class="kpi-card clickable" onclick="showDrilldown('mtd')" style="cursor:pointer;">
                <div class="value" style="color: var(--success);" id="pnlRevenue">$0</div>
                <div class="label">MTD Total Revenue</div>
            </div>
            <div class="kpi-card clickable" id="pnlProductCard" style="cursor:pointer;">
                <div class="value" style="color: #4ecdc4;" id="pnlProductRev">$0</div>
                <div class="label">Product Revenue</div>
            </div>
            <div class="kpi-card clickable" id="pnlServiceCard" style="cursor:pointer;">
                <div class="value" style="color: #ff6b6b;" id="pnlServiceRev">$0</div>
                <div class="label">Service Revenue</div>
            </div>
            <div class="kpi-card clickable" id="pnlOtherCard" style="cursor:pointer;">
                <div class="value" style="color: var(--warning);" id="pnlOtherRev">$0</div>
                <div class="label">Other Revenue</div>
            </div>
        </div>
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Revenue by Category (MTD)</div>
                <div class="chart-container tall"><canvas id="pnlCategoryChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Revenue Mix</div>
                <div class="chart-container tall"><canvas id="pnlMixPieChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Monthly Revenue Trend</div>
                <div class="chart-container tall"><canvas id="pnlMonthlyTrendChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Revenue Breakdown</div>
                <div style="padding: 15px;">
                    <div class="pnl-grid" id="pnlGrid">
                        <div class="pnl-section">
                            <div class="pnl-header">Revenue</div>
                            <div class="pnl-row" id="pnlProductRow">
                                <span>Product Sales (401000)</span>
                                <span class="amount">$0</span>
                            </div>
                            <div class="pnl-row" id="pnlServiceRow">
                                <span>Service Sales (402000)</span>
                                <span class="amount">$0</span>
                            </div>
                            <div class="pnl-row" id="pnlFreightRow">
                                <span>Freight Revenue (495400)</span>
                                <span class="amount">$0</span>
                            </div>
                            <div class="pnl-row" id="pnlMiscRow">
                                <span>Miscellaneous (495000)</span>
                                <span class="amount">$0</span>
                            </div>
                            <div class="pnl-row total" id="pnlTotalRow">
                                <span><strong>Total Revenue</strong></span>
                                <span class="amount"><strong>$0</strong></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashboard" style="margin-top: 20px;">
            <div class="card span-2">
                <div class="card-title">YTD vs Prior Year (Coming Soon)</div>
                <div style="padding: 40px; text-align: center; color: var(--text-secondary);">
                    <div style="font-size: 48px; margin-bottom: 15px;">ðŸ“Š</div>
                    <div>Year-over-year comparison will be available once we have prior year data in the GL.</div>
                </div>
            </div>
            <div class="card span-2">
                <div class="card-title">Revenue Performance Notes</div>
                <div style="padding: 15px; background: rgba(255,255,255,0.03); border-radius: 8px; font-size: 13px; line-height: 1.8;">
                    <strong>Data Source:</strong> SyteLine GL Ledger<br>
                    <strong>Revenue Accounts:</strong><br>
                    â€¢ 401000 = Product Sales (consolidated)<br>
                    â€¢ 402000 = Service Sales<br>
                    â€¢ 495000 = Miscellaneous Revenue<br>
                    â€¢ 495400 = Freight Revenue<br><br>
                    <strong>Classification:</strong> Product/Service split uses <code>itmuf_cti_product_category</code> field from item master applied per invoice line item.
                </div>
            </div>
        </div>
    </div>

    <!-- CASH FLOW PAGE -->
    <div id="cashflow" class="page">
        <div class="kpi-row">
            <div class="kpi-card clickable" id="cfThisWeekCard" style="cursor:pointer;">
                <div class="value" style="color: var(--success);" id="cfThisWeek">$0</div>
                <div class="label">This Week Forecast</div>
            </div>
            <div class="kpi-card clickable" id="cfNextWeekCard" style="cursor:pointer;">
                <div class="value" style="color: #4ecdc4;" id="cfNextWeek">$0</div>
                <div class="label">Next Week Forecast</div>
            </div>
            <div class="kpi-card">
                <div class="value" style="color: var(--warning);" id="cf6Week">$0</div>
                <div class="label">6-Week Total</div>
            </div>
            <div class="kpi-card clickable" onclick="showDrilldown('ar')" style="cursor:pointer;">
                <div class="value" style="color: var(--accent);" id="cfARDue">$0</div>
                <div class="label">AR Due Next 6 Weeks</div>
            </div>
        </div>
        <div class="dashboard">
            <div class="card span-3">
                <div class="card-title">6-Week Cash Flow Forecast</div>
                <div class="chart-container tall"><canvas id="cashFlowChart"></canvas></div>
            </div>
            <div class="card">
                <div class="card-title">Week-by-Week Breakdown</div>
                <div id="weekBreakdown" style="max-height: 500px; overflow-y: auto;"></div>
            </div>
        </div>
        <div class="dashboard" style="margin-top: 20px;">
            <div class="card span-2">
                <div class="card-title">Prediction Algorithm Details</div>
                <div style="padding: 15px; background: rgba(255,255,255,0.03); border-radius: 8px; font-size: 13px; line-height: 1.8;">
                    <strong>How the forecast is calculated:</strong><br>
                    â€¢ <strong>Historical Patterns:</strong> Weighted average of sales by day of week (60%)<br>
                    â€¢ <strong>AR Expectations:</strong> Expected collections from aging buckets (40%)<br>
                    â€¢ <strong>Collection Rates:</strong> Current 20%/wk, 1-30d 15%/wk, 31-60d 10%/wk<br>
                    â€¢ <strong>Actual Data:</strong> Days already passed use actual GL data<br>
                    â€¢ <strong>Weekend Rule:</strong> Saturday/Sunday sales roll into Monday<br>
                    â€¢ <strong>Confidence:</strong> Decreases with forecast distance<br>
                    <br>
                    <em style="color: var(--text-secondary);">Formula: (Historical DOW Avg Ã— 0.70) + (AR Collection Expectation Ã— 0.30)</em>
                </div>
            </div>
            <div class="card span-2">
                <div class="card-title">Historical Day-of-Week Averages</div>
                <div class="chart-container"><canvas id="dowAvgChart"></canvas></div>
            </div>
        </div>
    </div>

    <!-- CUSTOMERS PAGE -->
    <div id="customers" class="page">
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Top 15 Customers - Month to Date</div>
                <div class="chart-container tall"><canvas id="customerBarChart"></canvas></div>
            </div>
            <div class="card">
                <div class="card-title">Yesterday's Top Customers</div>
                <div class="top-list" id="topCustomersYesterday" style="max-height: 500px;"></div>
            </div>
            <div class="card">
                <div class="card-title">MTD Customer List</div>
                <div class="top-list" id="fullCustomerList" style="max-height: 500px;"></div>
            </div>
        </div>
    </div>

    <!-- PRODUCTS PAGE -->
    <div id="products" class="page">
        <div class="dashboard">
            <div class="card span-2">
                <div class="card-title">Top 15 Products - Month to Date</div>
                <div class="chart-container tall"><canvas id="productBarChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Product Category Mix</div>
                <div class="chart-container tall"><canvas id="productPieChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Full Product List (MTD)</div>
                <div class="top-list" id="fullProductList" style="max-height: 600px;"></div>
            </div>
        </div>
    </div>

    <!-- Drilldown Modal -->
    <div class="drilldown-overlay" id="drilldownOverlay" onclick="closeDrilldown(event)">
        <div class="drilldown-modal" onclick="event.stopPropagation()">
            <div class="drilldown-header">
                <h3 id="drilldownTitle">Details</h3>
                <button class="close-btn" onclick="closeDrilldown()">&times;</button>
            </div>
            <div class="drilldown-body" id="drilldownBody"></div>
        </div>
    </div>

    <!-- GEOGRAPHY PAGE -->
    <div id="geography" class="page">
        <div class="dashboard">
            <div class="card span-3">
                <div class="card-title">Shipping Destinations Heat Map</div>
                <div id="shippingMap"></div>
            </div>
            <div class="card">
                <div class="card-title">Top Shipping Locations</div>
                <div class="top-list" id="topLocations" style="max-height: 400px;"></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Shipments by State</div>
                <div class="chart-container tall"><canvas id="stateChart"></canvas></div>
            </div>
            <div class="card span-2">
                <div class="card-title">Service Tech Territory Coverage</div>
                <div id="serviceTechMap" style="height: 320px; border-radius: 10px;"></div>
                <div id="serviceTechLegend" style="margin-top: 10px; font-size: 11px; display: flex; gap: 15px; flex-wrap: wrap;"></div>
            </div>
        </div>
    </div>

    <script>
        // Data will be embedded here by the generator script
        let DATA = {
    "ClientCare":  {
                       "Yesterday":  [
                                         {
                                             "Username":  "marissa",
                                             "Type":  "ClientCare",
                                             "ProductAmount":  4517.00,
                                             "Role":  "Client Care",
                                             "Name":  "Marissa King",
                                             "CityCount":  14,
                                             "ServiceAmount":  0,
                                             "StateCount":  13,
                                             "Amount":  4517.00
                                         },
                                         {
                                             "Username":  "ebrow",
                                             "Type":  "ClientCare",
                                             "ProductAmount":  1413.00,
                                             "Role":  "Client Care",
                                             "Name":  "Emily Brown",
                                             "CityCount":  1,
                                             "ServiceAmount":  0,
                                             "StateCount":  1,
                                             "Amount":  1413.00
                                         },
                                         {
                                             "Username":  "cjord",
                                             "Type":  "ClientCare",
                                             "ProductAmount":  635.00,
                                             "Role":  "Client Care",
                                             "Name":  "Jordan Cline",
                                             "CityCount":  39,
                                             "ServiceAmount":  0,
                                             "StateCount":  23,
                                             "Amount":  635.00
                                         }
                                     ],
                       "MTD":  {

                               }
                   },
    "ServiceTeam":  {
                        "Yesterday":  [
                                          {
                                              "Username":  "bcoli",
                                              "Type":  "ServiceTeam",
                                              "ProductAmount":  0,
                                              "Role":  "Scheduling Coordinator",
                                              "Name":  "Colin Bowles",
                                              "CityCount":  4,
                                              "ServiceAmount":  4756.00,
                                              "StateCount":  4,
                                              "Amount":  4756.00
                                          },
                                          {
                                              "Username":  "hnich",
                                              "Type":  "ServiceTeam",
                                              "ProductAmount":  207.40,
                                              "Role":  "In-House Service Supervisor",
                                              "Name":  "Nicholas Hegger",
                                              "CityCount":  6,
                                              "ServiceAmount":  392.00,
                                              "StateCount":  5,
                                              "Amount":  599.40
                                          }
                                      ],
                        "MTD":  {

                                }
                    },
    "Period":  {
                   "MonthStart":  "2026-02-01",
                   "MTDBusinessDays":  0,
                   "YearStart":  "2026-01-01",
                   "Yesterday":  "2026-01-30",
                   "YTDBusinessDays":  22
               },
    "DailyTrend":  [
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-03",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-04",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Friday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-05",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Monday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-08",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Tuesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-09",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-10",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-11",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Friday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-12",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Monday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-15",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Tuesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-16",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-17",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-18",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Friday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-19",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Monday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-22",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Tuesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-23",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-24",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-25",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Friday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-26",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Monday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-29",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Tuesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-30",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2025-12-31",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2026-01-01",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Friday",
                           "Total":  0,
                           "Service":  0,
                           "Product":  0,
                           "Date":  "2026-01-02",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  8330.00,
                           "DayOfWeek":  "Monday",
                           "Total":  13472.10,
                           "Service":  2877.00,
                           "Product":  2265.10,
                           "Date":  "2026-01-05",
                           "Freight":  0
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Tuesday",
                           "Total":  15028.69,
                           "Service":  9353.00,
                           "Product":  5127.10,
                           "Date":  "2026-01-06",
                           "Freight":  548.59
                       },
                       {
                           "Miscellaneous":  4298.00,
                           "DayOfWeek":  "Wednesday",
                           "Total":  94347.44,
                           "Service":  49069.54,
                           "Product":  39227.70,
                           "Date":  "2026-01-07",
                           "Freight":  1752.20
                       },
                       {
                           "Miscellaneous":  1202.00,
                           "DayOfWeek":  "Thursday",
                           "Total":  143533.93,
                           "Service":  68662.70,
                           "Product":  67932.68,
                           "Date":  "2026-01-08",
                           "Freight":  5736.55
                       },
                       {
                           "Miscellaneous":  3168.64,
                           "DayOfWeek":  "Friday",
                           "Total":  97476.89,
                           "Service":  47511.40,
                           "Product":  43917.85,
                           "Date":  "2026-01-09",
                           "Freight":  2879.00
                       },
                       {
                           "Miscellaneous":  3413.00,
                           "DayOfWeek":  "Monday",
                           "Total":  230666.22,
                           "Service":  57649.00,
                           "Product":  160731.10,
                           "Date":  "2026-01-12",
                           "Freight":  8873.12
                       },
                       {
                           "Miscellaneous":  4565.00,
                           "DayOfWeek":  "Tuesday",
                           "Total":  372724.60,
                           "Service":  32982.29,
                           "Product":  320232.35,
                           "Date":  "2026-01-13",
                           "Freight":  14944.96
                       },
                       {
                           "Miscellaneous":  110.00,
                           "DayOfWeek":  "Wednesday",
                           "Total":  247578.71,
                           "Service":  36715.35,
                           "Product":  200708.35,
                           "Date":  "2026-01-14",
                           "Freight":  10045.01
                       },
                       {
                           "Miscellaneous":  1932.00,
                           "DayOfWeek":  "Thursday",
                           "Total":  146997.08,
                           "Service":  62171.70,
                           "Product":  78296.04,
                           "Date":  "2026-01-15",
                           "Freight":  4597.34
                       },
                       {
                           "Miscellaneous":  6738.00,
                           "DayOfWeek":  "Friday",
                           "Total":  210264.06,
                           "Service":  89703.15,
                           "Product":  108836.55,
                           "Date":  "2026-01-16",
                           "Freight":  4986.36
                       },
                       {
                           "Miscellaneous":  867.00,
                           "DayOfWeek":  "Monday",
                           "Total":  143253.96,
                           "Service":  40823.77,
                           "Product":  96687.40,
                           "Date":  "2026-01-19",
                           "Freight":  4875.79
                       },
                       {
                           "Miscellaneous":  65.00,
                           "DayOfWeek":  "Tuesday",
                           "Total":  169371.66,
                           "Service":  45962.80,
                           "Product":  115716.40,
                           "Date":  "2026-01-20",
                           "Freight":  7627.46
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Wednesday",
                           "Total":  135026.42,
                           "Service":  46135.10,
                           "Product":  85971.97,
                           "Date":  "2026-01-21",
                           "Freight":  2919.35
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Thursday",
                           "Total":  146161.22,
                           "Service":  16099.20,
                           "Product":  124617.80,
                           "Date":  "2026-01-22",
                           "Freight":  5444.22
                       },
                       {
                           "Miscellaneous":  260.67,
                           "DayOfWeek":  "Friday",
                           "Total":  220337.38,
                           "Service":  39107.14,
                           "Product":  174719.32,
                           "Date":  "2026-01-23",
                           "Freight":  6250.25
                       },
                       {
                           "Miscellaneous":  0,
                           "DayOfWeek":  "Monday",
                           "Total":  104569.88,
                           "Service":  47653.35,
                           "Product":  53396.30,
                           "Date":  "2026-01-26",
                           "Freight":  3520.23
                       },
                       {
                           "Miscellaneous":  3132.00,
                           "DayOfWeek":  "Tuesday",
                           "Total":  194963.67,
                           "Service":  56256.60,
                           "Product":  130463.20,
                           "Date":  "2026-01-27",
                           "Freight":  5111.87
                       },
                       {
                           "Miscellaneous":  39.33,
                           "DayOfWeek":  "Wednesday",
                           "Total":  186304.05,
                           "Service":  23482.18,
                           "Product":  159012.27,
                           "Date":  "2026-01-28",
                           "Freight":  3770.27
                       },
                       {
                           "Miscellaneous":  8389.25,
                           "DayOfWeek":  "Thursday",
                           "Total":  110765.12,
                           "Service":  39850.80,
                           "Product":  57580.65,
                           "Date":  "2026-01-29",
                           "Freight":  4944.42
                       },
                       {
                           "Miscellaneous":  1897.00,
                           "DayOfWeek":  "Friday",
                           "Total":  145630.69,
                           "Service":  81358.92,
                           "Product":  58677.40,
                           "Date":  "2026-01-30",
                           "Freight":  3697.37
                       }
                   ],
    "AllTeam":  {
                    "Yesterday":  [
                                      {
                                          "Username":  "Joel",
                                          "Type":  "Executive",
                                          "ProductAmount":  38486.40,
                                          "Role":  "COO",
                                          "Name":  "Joel EuDaly",
                                          "CityCount":  625,
                                          "ServiceAmount":  68317.92,
                                          "StateCount":  56,
                                          "Amount":  108210.32
                                      },
                                      {
                                          "Username":  "Allison",
                                          "Type":  "Admin",
                                          "ProductAmount":  8886.70,
                                          "Role":  "Accounting",
                                          "Name":  "Allison White",
                                          "CityCount":  52,
                                          "ServiceAmount":  196.00,
                                          "StateCount":  31,
                                          "Amount":  9082.70
                                      },
                                      {
                                          "Username":  "lphil",
                                          "Type":  "Sales",
                                          "ProductAmount":  3805.20,
                                          "Role":  "Inside Sales",
                                          "Name":  "Phil Libbert",
                                          "CityCount":  53,
                                          "ServiceAmount":  3502.00,
                                          "StateCount":  28,
                                          "Amount":  7798.20
                                      },
                                      {
                                          "Username":  "bcoli",
                                          "Type":  "ServiceTeam",
                                          "ProductAmount":  0,
                                          "Role":  "Scheduling Coordinator",
                                          "Name":  "Colin Bowles",
                                          "CityCount":  4,
                                          "ServiceAmount":  4756.00,
                                          "StateCount":  4,
                                          "Amount":  4756.00
                                      },
                                      {
                                          "Username":  "nandy",
                                          "Type":  "Sales",
                                          "ProductAmount":  470.00,
                                          "Role":  "Outside Sales",
                                          "Name":  "Andy Neptune",
                                          "CityCount":  13,
                                          "ServiceAmount":  4195.00,
                                          "StateCount":  10,
                                          "Amount":  4665.00
                                      },
                                      {
                                          "Username":  "marissa",
                                          "Type":  "ClientCare",
                                          "ProductAmount":  4517.00,
                                          "Role":  "Client Care",
                                          "Name":  "Marissa King",
                                          "CityCount":  14,
                                          "ServiceAmount":  0,
                                          "StateCount":  13,
                                          "Amount":  4517.00
                                      },
                                      {
                                          "Username":  "ebrow",
                                          "Type":  "ClientCare",
                                          "ProductAmount":  1413.00,
                                          "Role":  "Client Care",
                                          "Name":  "Emily Brown",
                                          "CityCount":  1,
                                          "ServiceAmount":  0,
                                          "StateCount":  1,
                                          "Amount":  1413.00
                                      },
                                      {
                                          "Username":  "cjord",
                                          "Type":  "ClientCare",
                                          "ProductAmount":  635.00,
                                          "Role":  "Client Care",
                                          "Name":  "Jordan Cline",
                                          "CityCount":  39,
                                          "ServiceAmount":  0,
                                          "StateCount":  23,
                                          "Amount":  635.00
                                      },
                                      {
                                          "Username":  "hnich",
                                          "Type":  "ServiceTeam",
                                          "ProductAmount":  207.40,
                                          "Role":  "In-House Service Supervisor",
                                          "Name":  "Nicholas Hegger",
                                          "CityCount":  6,
                                          "ServiceAmount":  392.00,
                                          "StateCount":  5,
                                          "Amount":  599.40
                                      },
                                      {
                                          "Username":  "Greg",
                                          "Type":  "Sales",
                                          "ProductAmount":  256.70,
                                          "Role":  "Inside Sales",
                                          "Name":  "Greg Smith",
                                          "CityCount":  6,
                                          "ServiceAmount":  0,
                                          "StateCount":  6,
                                          "Amount":  256.70
                                      }
                                  ],
                    "MTD":  {

                            }
                },
    "TopCustomers":  {
                         "Yesterday":  [
                                           {
                                               "Name":  "Tyson - (FM) Logansport",
                                               "Amount":  12421.40
                                           },
                                           {
                                               "Name":  "SHAMBAUGH \u0026 SON - CORPORATE",
                                               "Amount":  7654.22
                                           },
                                           {
                                               "Name":  "Wyatt Refrigeration LLC",
                                               "Amount":  6447.70
                                           },
                                           {
                                               "Name":  "JOHNSON CONTROLS FIRE PROTECTION",
                                               "Amount":  5954.70
                                           },
                                           {
                                               "Name":  "US Cold Storage #170 - Warsaw",
                                               "Amount":  5674.50
                                           },
                                           {
                                               "Name":  "Aurora Organic Dairy - Platteville",
                                               "Amount":  4665.00
                                           },
                                           {
                                               "Name":  "VibrAnalysis, Inc.",
                                               "Amount":  4517.00
                                           },
                                           {
                                               "Name":  "OSI Industries - Chicago",
                                               "Amount":  4481.00
                                           },
                                           {
                                               "Name":  "Amazon (DCH6) - Direct - Romeoville",
                                               "Amount":  4077.00
                                           },
                                           {
                                               "Name":  "80 Acres Urban Agriculture",
                                               "Amount":  3993.00
                                           },
                                           {
                                               "Name":  "Coca-Cola Chesterman Company",
                                               "Amount":  3623.00
                                           },
                                           {
                                               "Name":  "Creative Food Ingredients",
                                               "Amount":  3499.00
                                           },
                                           {
                                               "Name":  "SIEMENS INDUSTRY - CORPORATE",
                                               "Amount":  3300.70
                                           },
                                           {
                                               "Name":  "Drennan Refrigeration Inc.",
                                               "Amount":  3259.20
                                           },
                                           {
                                               "Name":  "Independent Refrigeration Services - York",
                                               "Amount":  3228.40
                                           }
                                       ],
                         "MTD":  {

                                 }
                     },
    "DayOfWeekAverages":  {
                              "Tuesday":  188022.16,
                              "Monday":  122990.54,
                              "Friday":  168427.26,
                              "Wednesday":  165814.16,
                              "Thursday":  136864.34
                          },
    "Salesperson":  {
                        "Yesterday":  [
                                          {
                                              "Username":  "lphil",
                                              "Type":  "Sales",
                                              "ProductAmount":  3805.20,
                                              "Role":  "Inside Sales",
                                              "Name":  "Phil Libbert",
                                              "CityCount":  53,
                                              "ServiceAmount":  3502.00,
                                              "StateCount":  28,
                                              "Amount":  7798.20
                                          },
                                          {
                                              "Username":  "nandy",
                                              "Type":  "Sales",
                                              "ProductAmount":  470.00,
                                              "Role":  "Outside Sales",
                                              "Name":  "Andy Neptune",
                                              "CityCount":  13,
                                              "ServiceAmount":  4195.00,
                                              "StateCount":  10,
                                              "Amount":  4665.00
                                          },
                                          {
                                              "Username":  "Greg",
                                              "Type":  "Sales",
                                              "ProductAmount":  256.70,
                                              "Role":  "Inside Sales",
                                              "Name":  "Greg Smith",
                                              "CityCount":  6,
                                              "ServiceAmount":  0,
                                              "StateCount":  6,
                                              "Amount":  256.70
                                          }
                                      ],
                        "MTD":  {

                                }
                    },
    "ARaging":  {
                    "Current":  3491325.90,
                    "Days90Plus":  247543.65,
                    "Days31_60":  144382.98,
                    "Total":  4642893.44,
                    "Days1_30":  589533.62,
                    "Days61_90":  170107.29
                },
    "GeneratedAt":  "2026-02-01 10:08:12",
    "FieldTechSummary":  {
                             "TotalAppointmentsMTD":  0,
                             "TopPerformer":  "--",
                             "TotalStatesCovered":  0,
                             "TotalTechs":  0
                         },
    "TopProducts":  {
                        "MTD":  [
                                    {
                                        "Amount":  358847.30,
                                        "Description":  "CTI tech on-site for calibration of up t",
                                        "Item":  "CTI TECH ON SITE"
                                    },
                                    {
                                        "Amount":  354253.76,
                                        "Description":  "Gas Sensor, Ammonia 0-100 ppm, 4/20 mA o",
                                        "Item":  "GG-NH3-100"
                                    },
                                    {
                                        "Amount":  157780.70,
                                        "Description":  "Replacement Electrochemical Cell, NH3, r",
                                        "Item":  "GG-NH3-RC"
                                    },
                                    {
                                        "Amount":  143184.30,
                                        "Description":  "Additional Sensor (above 12) onsite cali",
                                        "Item":  "CAL ADD"
                                    },
                                    {
                                        "Amount":  97279.58,
                                        "Description":  "Gas Sensor, Vent Line, catalytic-bead, A",
                                        "Item":  "GG-VL2-NH3"
                                    },
                                    {
                                        "Amount":  95428.80,
                                        "Description":  "Gas Sensor, Ammonia 0-250 ppm, 4/20 mA o",
                                        "Item":  "GG-NH3-250"
                                    },
                                    {
                                        "Amount":  85187.72,
                                        "Description":  "Americold 3 year SA.  Flat rate per site",
                                        "Item":  "AMERICOLD SA 2024-2026"
                                    },
                                    {
                                        "Amount":  85078.07,
                                        "Description":  "Certified Calibration Gas, 17L Cylinder,",
                                        "Item":  "TB17L CAL GAS"
                                    },
                                    {
                                        "Amount":  78329.00,
                                        "Description":  "CTI tech on-site for calibration of up t",
                                        "Item":  "CTI TECH ON SITE - WEEKEND"
                                    },
                                    {
                                        "Amount":  68135.75,
                                        "Description":  "Wingman F1 portable gas detector, Ammoni",
                                        "Item":  "F1-NH3"
                                    },
                                    {
                                        "Amount":  66665.50,
                                        "Description":  "Gas Sensor, Carbon Monoxide (0-200 ppm),",
                                        "Item":  "DUOSENSE-M"
                                    },
                                    {
                                        "Amount":  66494.05,
                                        "Description":  "Gas Detection Entrance Monitor, White, L",
                                        "Item":  "EM2-24"
                                    },
                                    {
                                        "Amount":  55271.60,
                                        "Description":  "Certified Calibration Gas, 34L Cylinder,",
                                        "Item":  "RB34L-NH3/100"
                                    },
                                    {
                                        "Amount":  53572.60,
                                        "Description":  "Gas Sensor, Ammonia 0-100 ppm, 4/20 mA o",
                                        "Item":  "GG-NH3-100-ST"
                                    },
                                    {
                                        "Amount":  51147.30,
                                        "Description":  "Certified Calibration Gas, 17L Cylinder,",
                                        "Item":  "RB17L-NH3/100"
                                    }
                                ]
                    },
    "CashFlowPrediction":  [
                               {
                                   "Total":  742233.41,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-01-26",
                                                            "Amount":  104569.88,
                                                            "Type":  "Actual",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-01-27",
                                                            "Amount":  194963.67,
                                                            "Type":  "Actual",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-01-28",
                                                            "Amount":  186304.05,
                                                            "Type":  "Actual",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-01-29",
                                                            "Amount":  110765.12,
                                                            "Type":  "Actual",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-01-30",
                                                            "Amount":  145630.69,
                                                            "Type":  "Actual",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-01-30",
                                   "ExpectedCollections":  325835.90,
                                   "Actual":  742233.41,
                                   "Sources":  {
                                                   "From61_90":  8505.36,
                                                   "From1_30":  88430.04,
                                                   "FromCurrent":  698265.18,
                                                   "From90Plus":  4950.87,
                                                   "From31_60":  14438.30
                                               },
                                   "StartDate":  "2026-01-26",
                                   "Predicted":  0,
                                   "ARDue":  155688.43,
                                   "WeekNum":  1,
                                   "Week":  "Week of Jan 26",
                                   "Confidence":  90
                               },
                               {
                                   "Total":  624940.37,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-02-02",
                                                            "Amount":  97711.99,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-03",
                                                            "Amount":  150979.87,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-04",
                                                            "Amount":  135434.27,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-05",
                                                            "Amount":  111296.53,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-06",
                                                            "Amount":  129517.7,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-02-06",
                                   "ExpectedCollections":  258191.48,
                                   "Actual":  0,
                                   "Sources":  {
                                                   "From61_90":  7758.55,
                                                   "From1_30":  157797.75,
                                                   "FromCurrent":  450096.8,
                                                   "From90Plus":  5702.4,
                                                   "From31_60":  24123.2
                                               },
                                   "StartDate":  "2026-02-02",
                                   "Predicted":  624940.37,
                                   "ARDue":  329280.05,
                                   "WeekNum":  2,
                                   "Week":  "Week of Feb 2",
                                   "Confidence":  38
                               },
                               {
                                   "Total":  614070.62,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-02-09",
                                                            "Amount":  96081.53,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-10",
                                                            "Amount":  148262.44,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-11",
                                                            "Amount":  132716.84,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-12",
                                                            "Amount":  109122.58,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-13",
                                                            "Amount":  127887.24,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-02-13",
                                   "ExpectedCollections":  221959,
                                   "Actual":  0,
                                   "Sources":  {
                                                   "From61_90":  8446.4,
                                                   "From1_30":  162193.2,
                                                   "FromCurrent":  335914,
                                                   "From90Plus":  6364.2,
                                                   "From31_60":  41979.7
                                               },
                                   "StartDate":  "2026-02-09",
                                   "Predicted":  614070.62,
                                   "ARDue":  973596.03,
                                   "WeekNum":  3,
                                   "Week":  "Week of Feb 9",
                                   "Confidence":  30
                               },
                               {
                                   "Total":  543713.91,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-02-16",
                                                            "Amount":  19438.19,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-17",
                                                            "Amount":  150111.45,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-18",
                                                            "Amount":  134565.85,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-19",
                                                            "Amount":  110601.79,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-20",
                                                            "Amount":  128996.64,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-02-20",
                                   "ExpectedCollections":  246612.46,
                                   "Actual":  0,
                                   "Sources":  {
                                                   "From61_90":  11159.95,
                                                   "From1_30":  147703.05,
                                                   "FromCurrent":  396267.6,
                                                   "From90Plus":  7081.56,
                                                   "From31_60":  54319
                                               },
                                   "StartDate":  "2026-02-16",
                                   "Predicted":  543713.91,
                                   "ARDue":  686765.24,
                                   "WeekNum":  4,
                                   "Week":  "Week of Feb 16",
                                   "Confidence":  30
                               },
                               {
                                   "Total":  620173.87,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-02-23",
                                                            "Amount":  96997.02,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-24",
                                                            "Amount":  149788.25,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-25",
                                                            "Amount":  134242.65,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-26",
                                                            "Amount":  110343.23,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-02-27",
                                                            "Amount":  128802.72,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-02-27",
                                   "ExpectedCollections":  242303.15,
                                   "Actual":  0,
                                   "Sources":  {
                                                   "From61_90":  14601.85,
                                                   "From1_30":  148062,
                                                   "FromCurrent":  375113.6,
                                                   "From90Plus":  8055.92,
                                                   "From31_60":  59924.5
                                               },
                                   "StartDate":  "2026-02-23",
                                   "Predicted":  620173.87,
                                   "ARDue":  672510.83,
                                   "WeekNum":  5,
                                   "Week":  "Week of Feb 23",
                                   "Confidence":  22
                               },
                               {
                                   "Total":  618927.25,
                                   "DayBreakdown":  [
                                                        {
                                                            "Date":  "2026-03-02",
                                                            "Amount":  96810.03,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Monday"
                                                        },
                                                        {
                                                            "Date":  "2026-03-03",
                                                            "Amount":  149476.59,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Tuesday"
                                                        },
                                                        {
                                                            "Date":  "2026-03-04",
                                                            "Amount":  133930.99,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Wednesday"
                                                        },
                                                        {
                                                            "Date":  "2026-03-05",
                                                            "Amount":  110093.9,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Thursday"
                                                        },
                                                        {
                                                            "Date":  "2026-03-06",
                                                            "Amount":  128615.73,
                                                            "Type":  "Predicted",
                                                            "DayOfWeek":  "Friday"
                                                        }
                                                    ],
                                   "EndDate":  "2026-03-06",
                                   "ExpectedCollections":  238147.77,
                                   "Actual":  0,
                                   "Sources":  {
                                                   "From61_90":  17711.85,
                                                   "From1_30":  145104.3,
                                                   "FromCurrent":  359570.4,
                                                   "From90Plus":  9354.98,
                                                   "From31_60":  63627.9
                                               },
                                   "StartDate":  "2026-03-02",
                                   "Predicted":  618927.25,
                                   "ARDue":  91365.90,
                                   "WeekNum":  6,
                                   "Week":  "Week of Mar 2",
                                   "Confidence":  22
                               }
                           ],
    "Summary":  {
                    "YTDDailyAverage":  142203.35,
                    "YTD":  {
                                "Total":  3128473.77,
                                "Freight":  102524.36,
                                "Service":  893424.99,
                                "Miscellaneous":  48406.89,
                                "Product":  2084117.53
                            },
                    "MTD":  {
                                "Total":  0,
                                "Freight":  0,
                                "Service":  0,
                                "Miscellaneous":  0,
                                "Product":  0
                            },
                    "Yesterday":  {
                                      "Total":  145630.69,
                                      "Freight":  3697.37,
                                      "Service":  81358.92,
                                      "Miscellaneous":  1897.00,
                                      "Product":  58677.40
                                  },
                    "MTDDailyAverage":  0
                },
    "ShippingStats":  {
                          "MTDUSStates":  0,
                          "TotalUSStates":  50,
                          "StateBreakdown":  {
                                                 "KY":  10,
                                                 "IA":  43,
                                                 "VA":  17,
                                                 "TN":  19,
                                                 "WY":  3,
                                                 "SC":  21,
                                                 "CT":  8,
                                                 "FL":  32,
                                                 "GA":  36,
                                                 "NJ":  7,
                                                 "AK":  1,
                                                 "MT":  2,
                                                 "OR":  22,
                                                 "WV":  1,
                                                 "ME":  4,
                                                 "ND":  1,
                                                 "DE":  15,
                                                 "IN":  41,
                                                 "AR":  19,
                                                 "NH":  1,
                                                 "AL":  31,
                                                 "MA":  14,
                                                 "PA":  72,
                                                 "AZ":  10,
                                                 "OK":  13,
                                                 "TX":  79,
                                                 "UT":  15,
                                                 "CO":  24,
                                                 "NM":  3,
                                                 "WI":  75,
                                                 "SD":  4,
                                                 "MO":  36,
                                                 "ID":  7,
                                                 "NY":  16,
                                                 "RI":  2,
                                                 "MI":  36,
                                                 "NV":  4,
                                                 "MS":  6,
                                                 "KS":  12,
                                                 "MD":  16,
                                                 "MN":  42,
                                                 "CA":  162,
                                                 "NE":  23,
                                                 "LA":  2,
                                                 "OH":  42,
                                                 "NC":  38,
                                                 "VT":  3,
                                                 "IL":  44,
                                                 "HI":  1,
                                                 "WA":  51
                                             }
                      },
    "FieldTechnicians":  {

                         },
    "DataSource":  "SyteLine GL Ledger with ProductCode (LFTR/LGAS/LIHL=Service)",
    "ShippingHeatMap":  [
                            {
                                "Zip":  "54603",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "La Crosse"
                            },
                            {
                                "Zip":  "29006",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Batesburg"
                            },
                            {
                                "Zip":  "31408",
                                "State":  "GA",
                                "Count":  4,
                                "City":  "Savannah"
                            },
                            {
                                "Zip":  "83338",
                                "State":  "ID",
                                "Count":  2,
                                "City":  "Jerome"
                            },
                            {
                                "Zip":  "52501",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Ottumwa"
                            },
                            {
                                "Zip":  "56031",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Fairmont"
                            },
                            {
                                "Zip":  "24153",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Salem"
                            },
                            {
                                "Zip":  "02760",
                                "State":  "MA",
                                "Count":  1,
                                "City":  "North Attleborough"
                            },
                            {
                                "Zip":  "49426",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Hudsonville"
                            },
                            {
                                "Zip":  "14787",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Westfield"
                            },
                            {
                                "Zip":  "51012",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Cherokee"
                            },
                            {
                                "Zip":  "75052",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Grand Prairie"
                            },
                            {
                                "Zip":  "17543",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Lititz"
                            },
                            {
                                "Zip":  "75141",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Hutchins"
                            },
                            {
                                "Zip":  "72701",
                                "State":  "AR",
                                "Count":  2,
                                "City":  "Fayetteville"
                            },
                            {
                                "Zip":  "17901",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Pottsville"
                            },
                            {
                                "Zip":  "98199",
                                "State":  "WA",
                                "Count":  11,
                                "City":  "Seattle"
                            },
                            {
                                "Zip":  "68137",
                                "State":  "NE",
                                "Count":  10,
                                "City":  "Omaha"
                            },
                            {
                                "Zip":  "64804",
                                "State":  "MO",
                                "Count":  3,
                                "City":  "Joplin"
                            },
                            {
                                "Zip":  "35957",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Boaz"
                            },
                            {
                                "Zip":  "60467",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Orland Park"
                            },
                            {
                                "Zip":  "23666",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Hampton"
                            },
                            {
                                "Zip":  "49735",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Gaylord"
                            },
                            {
                                "Zip":  "26003",
                                "State":  "WV",
                                "Count":  1,
                                "City":  "Wheeling"
                            },
                            {
                                "Zip":  "08037",
                                "State":  "NJ",
                                "Count":  1,
                                "City":  "Hammonton"
                            },
                            {
                                "Zip":  "52641",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Mount Pleasant"
                            },
                            {
                                "Zip":  "V4W 2W8",
                                "State":  "BC-C",
                                "Count":  1,
                                "City":  "Aldergrove"
                            },
                            {
                                "Zip":  "61008",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Belvidere"
                            },
                            {
                                "Zip":  "60957",
                                "State":  "IL",
                                "Count":  4,
                                "City":  "Paxton"
                            },
                            {
                                "Zip":  "27529",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Garner"
                            },
                            {
                                "Zip":  "44870",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Sandusky"
                            },
                            {
                                "Zip":  "60484",
                                "State":  "IL",
                                "Count":  2,
                                "City":  "University Park"
                            },
                            {
                                "Zip":  "51031",
                                "State":  "IA",
                                "Count":  2,
                                "City":  "Le Mars"
                            },
                            {
                                "Zip":  "29847",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Trenton"
                            },
                            {
                                "Zip":  "49646",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Kalkaska"
                            },
                            {
                                "Zip":  "21220",
                                "State":  "MD",
                                "Count":  5,
                                "City":  "Baltimore"
                            },
                            {
                                "Zip":  "96819",
                                "State":  "HI",
                                "Count":  1,
                                "City":  "Honolulu"
                            },
                            {
                                "Zip":  "04740",
                                "State":  "ME",
                                "Count":  1,
                                "City":  "Easton"
                            },
                            {
                                "Zip":  "68766",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "South Sioux City"
                            },
                            {
                                "Zip":  "98264",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Lynden"
                            },
                            {
                                "Zip":  "54130",
                                "State":  "WI",
                                "Count":  5,
                                "City":  "Kaukauna"
                            },
                            {
                                "Zip":  "70806",
                                "State":  "LA",
                                "Count":  1,
                                "City":  "Baton Rouge"
                            },
                            {
                                "Zip":  "45385",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Xenia"
                            },
                            {
                                "Zip":  "17331",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "HANOVER"
                            },
                            {
                                "Zip":  "42101",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "Bowling Green"
                            },
                            {
                                "Zip":  "44146",
                                "State":  "OH",
                                "Count":  2,
                                "City":  "Bedford Heights"
                            },
                            {
                                "Zip":  "55309",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Big Lake"
                            },
                            {
                                "Zip":  "56156",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Luverne"
                            },
                            {
                                "Zip":  "52806",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Davenport"
                            },
                            {
                                "Zip":  "31730-7432",
                                "State":  "GA",
                                "Count":  2,
                                "City":  "Camilla"
                            },
                            {
                                "Zip":  "48849",
                                "State":  "MI",
                                "Count":  2,
                                "City":  "Lake Odessa"
                            },
                            {
                                "Zip":  "82604",
                                "State":  "WY",
                                "Count":  1,
                                "City":  "Casper"
                            },
                            {
                                "Zip":  "43402",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Bowling Green"
                            },
                            {
                                "Zip":  "17019",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Dillsburg"
                            },
                            {
                                "Zip":  "30643",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Hartwell"
                            },
                            {
                                "Zip":  "14543",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Rush"
                            },
                            {
                                "Zip":  "44104",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Cleveland"
                            },
                            {
                                "Zip":  "17801",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Sunbury"
                            },
                            {
                                "Zip":  "54401",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Wausau"
                            },
                            {
                                "Zip":  "91761",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Ontario"
                            },
                            {
                                "Zip":  "80640",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Henderson"
                            },
                            {
                                "Zip":  "73401",
                                "State":  "OK",
                                "Count":  2,
                                "City":  "Ardmore"
                            },
                            {
                                "Zip":  "95301",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Atwater"
                            },
                            {
                                "Zip":  "74055",
                                "State":  "OK",
                                "Count":  2,
                                "City":  "Owasso"
                            },
                            {
                                "Zip":  "51101",
                                "State":  "IA",
                                "Count":  8,
                                "City":  "Sioux City"
                            },
                            {
                                "Zip":  "63134",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Berkeley"
                            },
                            {
                                "Zip":  "44647",
                                "State":  "OH",
                                "Count":  3,
                                "City":  "Massillon"
                            },
                            {
                                "Zip":  "91733",
                                "State":  "CA",
                                "Count":  5,
                                "City":  "South El Monte"
                            },
                            {
                                "Zip":  "39601",
                                "State":  "MS",
                                "Count":  1,
                                "City":  "Brookhaven"
                            },
                            {
                                "Zip":  "56232",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Dawson"
                            },
                            {
                                "Zip":  "5010",
                                "State":  "NZ-WG",
                                "Count":  1,
                                "City":  "Lower Hutt"
                            },
                            {
                                "Zip":  "29506",
                                "State":  "SC",
                                "Count":  2,
                                "City":  "Florence"
                            },
                            {
                                "Zip":  "90631",
                                "State":  "CA",
                                "Count":  4,
                                "City":  "La Habra"
                            },
                            {
                                "Zip":  "84088",
                                "State":  "UT",
                                "Count":  2,
                                "City":  "West Jordan"
                            },
                            {
                                "Zip":  "53959",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Reedsburg"
                            },
                            {
                                "Zip":  "37408",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Chattanooga"
                            },
                            {
                                "Zip":  "99301",
                                "State":  "WA",
                                "Count":  6,
                                "City":  "Pasco"
                            },
                            {
                                "Zip":  "7570027",
                                "State":  "RM",
                                "Count":  1,
                                "City":  "Las Condes"
                            },
                            {
                                "Zip":  "91356",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Los Angeles"
                            },
                            {
                                "Zip":  "49321",
                                "State":  "MI",
                                "Count":  2,
                                "City":  "Comstock Park"
                            },
                            {
                                "Zip":  "97210",
                                "State":  "OR",
                                "Count":  6,
                                "City":  "Portland"
                            },
                            {
                                "Zip":  "54603",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "LaCrosse"
                            },
                            {
                                "Zip":  "21830",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Hebron"
                            },
                            {
                                "Zip":  "75141",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Hutchens"
                            },
                            {
                                "Zip":  "85213",
                                "State":  "AZ",
                                "Count":  1,
                                "City":  "Mesa"
                            },
                            {
                                "Zip":  "44512",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Youngstown"
                            },
                            {
                                "Zip":  "97317",
                                "State":  "OR",
                                "Count":  5,
                                "City":  "Salem"
                            },
                            {
                                "Zip":  "97322",
                                "State":  "OR",
                                "Count":  2,
                                "City":  "Albany"
                            },
                            {
                                "Zip":  "28103",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Marshville"
                            },
                            {
                                "Zip":  "57103",
                                "State":  "SD",
                                "Count":  3,
                                "City":  "Sioux Falls"
                            },
                            {
                                "Zip":  "57252",
                                "State":  "SD",
                                "Count":  1,
                                "City":  "Milbank"
                            },
                            {
                                "Zip":  "45869",
                                "State":  "OH",
                                "Count":  3,
                                "City":  "New Bremen"
                            },
                            {
                                "Zip":  "76903",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "San Angelo"
                            },
                            {
                                "Zip":  "28655",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Morganton"
                            },
                            {
                                "Zip":  "95633",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Garden Valley"
                            },
                            {
                                "Zip":  "78163",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Bulverde"
                            },
                            {
                                "Zip":  "35752",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Hollywood"
                            },
                            {
                                "Zip":  "76705",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Waco"
                            },
                            {
                                "Zip":  "17201",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Chambersburg"
                            },
                            {
                                "Zip":  "85034",
                                "State":  "AZ",
                                "Count":  1,
                                "City":  "Phoenix"
                            },
                            {
                                "Zip":  "38751",
                                "State":  "MS",
                                "Count":  1,
                                "City":  "Indianola"
                            },
                            {
                                "Zip":  "19014",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Upper Chichester"
                            },
                            {
                                "Zip":  "31322",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Pooler"
                            },
                            {
                                "Zip":  "55071",
                                "State":  "MN",
                                "Count":  3,
                                "City":  "Saint Paul Park"
                            },
                            {
                                "Zip":  "76262",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Roanoke"
                            },
                            {
                                "Zip":  "46952",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Marion"
                            },
                            {
                                "Zip":  "80239",
                                "State":  "CO",
                                "Count":  2,
                                "City":  "Denver"
                            },
                            {
                                "Zip":  "55362",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Monticello"
                            },
                            {
                                "Zip":  "46755",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Kendallville"
                            },
                            {
                                "Zip":  "68701",
                                "State":  "NE",
                                "Count":  2,
                                "City":  "Norfolk"
                            },
                            {
                                "Zip":  "48188",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Canton Township"
                            },
                            {
                                "Zip":  "45011",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Hamilton"
                            },
                            {
                                "Zip":  "42350-2001",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "Island"
                            },
                            {
                                "Zip":  "97818",
                                "State":  "OR",
                                "Count":  5,
                                "City":  "Boardman"
                            },
                            {
                                "Zip":  "18507",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Moosic"
                            },
                            {
                                "Zip":  "55304",
                                "State":  "MN",
                                "Count":  3,
                                "City":  "Ham Lake"
                            },
                            {
                                "Zip":  "66436",
                                "State":  "KS",
                                "Count":  1,
                                "City":  "Holton"
                            },
                            {
                                "Zip":  "60624",
                                "State":  "IL",
                                "Count":  2,
                                "City":  "Chicago"
                            },
                            {
                                "Zip":  "39422",
                                "State":  "MS",
                                "Count":  1,
                                "City":  "Bay Springs"
                            },
                            {
                                "Zip":  "49455",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Shelby"
                            },
                            {
                                "Zip":  "76137",
                                "State":  "TX",
                                "Count":  4,
                                "City":  "Fort Worth"
                            },
                            {
                                "Zip":  "19801",
                                "State":  "DE",
                                "Count":  1,
                                "City":  "Wilmington"
                            },
                            {
                                "Zip":  "68803",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Grand Island"
                            },
                            {
                                "Zip":  "72833",
                                "State":  "AR",
                                "Count":  2,
                                "City":  "Danville"
                            },
                            {
                                "Zip":  "14224",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "West Seneca"
                            },
                            {
                                "Zip":  "12866",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Saratoga Springs"
                            },
                            {
                                "Zip":  "35961",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "Collinsville"
                            },
                            {
                                "Zip":  "73127",
                                "State":  "OK",
                                "Count":  2,
                                "City":  "Oklahoma City"
                            },
                            {
                                "Zip":  "42602",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "Albany"
                            },
                            {
                                "Zip":  "27560",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Morrisville"
                            },
                            {
                                "Zip":  "V4N 4G1",
                                "State":  "BC-C",
                                "Count":  2,
                                "City":  "Surrey"
                            },
                            {
                                "Zip":  "01887",
                                "State":  "MA",
                                "Count":  4,
                                "City":  "Wilmington"
                            },
                            {
                                "Zip":  "15666",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Mount Pleasant"
                            },
                            {
                                "Zip":  "24592",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "South Boston"
                            },
                            {
                                "Zip":  "06118",
                                "State":  "CT",
                                "Count":  1,
                                "City":  "East Hartford"
                            },
                            {
                                "Zip":  "94577",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "San Leandro"
                            },
                            {
                                "Zip":  "93722",
                                "State":  "CA",
                                "Count":  12,
                                "City":  "Fresno"
                            },
                            {
                                "Zip":  "60915",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Bradley"
                            },
                            {
                                "Zip":  "33167",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Miami"
                            },
                            {
                                "Zip":  "27886",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Tarboro"
                            },
                            {
                                "Zip":  "92509",
                                "State":  "CA",
                                "Count":  6,
                                "City":  "Riverside"
                            },
                            {
                                "Zip":  "28078",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Huntersville"
                            },
                            {
                                "Zip":  "46542",
                                "State":  "IN",
                                "Count":  2,
                                "City":  "Milford"
                            },
                            {
                                "Zip":  "53511",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "Beloit"
                            },
                            {
                                "Zip":  "60538",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Montgomery"
                            },
                            {
                                "Zip":  "60440",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Bolingbrook"
                            },
                            {
                                "Zip":  "05478",
                                "State":  "VT",
                                "Count":  1,
                                "City":  "Saint Albans"
                            },
                            {
                                "Zip":  "53208",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Milwaukee"
                            },
                            {
                                "Zip":  "50138",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Knoxville"
                            },
                            {
                                "Zip":  "55441",
                                "State":  "MN",
                                "Count":  6,
                                "City":  "Plymouth"
                            },
                            {
                                "Zip":  "L5S 1T7",
                                "State":  "ON-C",
                                "Count":  4,
                                "City":  "Mississauga"
                            },
                            {
                                "Zip":  "93458",
                                "State":  "CA",
                                "Count":  6,
                                "City":  "Santa Maria"
                            },
                            {
                                "Zip":  "16802",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "University Park"
                            },
                            {
                                "Zip":  "36854",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Valley"
                            },
                            {
                                "Zip":  "22546",
                                "State":  "VA",
                                "Count":  2,
                                "City":  "Ruther Glen"
                            },
                            {
                                "Zip":  "30084",
                                "State":  "GA",
                                "Count":  4,
                                "City":  "Tucker"
                            },
                            {
                                "Zip":  "61081",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Sterling"
                            },
                            {
                                "Zip":  "97124",
                                "State":  "OR",
                                "Count":  1,
                                "City":  "Hillsboro"
                            },
                            {
                                "Zip":  "94587",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Union City"
                            },
                            {
                                "Zip":  "50704",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Waterloo"
                            },
                            {
                                "Zip":  "56352",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Melrose"
                            },
                            {
                                "Zip":  "17522",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Ephrata"
                            },
                            {
                                "Zip":  "27597",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Zebulon"
                            },
                            {
                                "Zip":  "72802",
                                "State":  "AR",
                                "Count":  1,
                                "City":  "Russellville"
                            },
                            {
                                "Zip":  "45502",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Springfield"
                            },
                            {
                                "Zip":  "60527",
                                "State":  "IL",
                                "Count":  2,
                                "City":  "Willowbrook"
                            },
                            {
                                "Zip":  "54413",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Babcock"
                            },
                            {
                                "Zip":  "44730",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "East Canton"
                            },
                            {
                                "Zip":  "92626",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Costa Mesa"
                            },
                            {
                                "Zip":  "18434",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Jessup"
                            },
                            {
                                "Zip":  "72638",
                                "State":  "AR",
                                "Count":  1,
                                "City":  "Green Forest"
                            },
                            {
                                "Zip":  "46947",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Logansport"
                            },
                            {
                                "Zip":  "74110",
                                "State":  "OK",
                                "Count":  3,
                                "City":  "Tulsa"
                            },
                            {
                                "Zip":  "48166",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Newport"
                            },
                            {
                                "Zip":  "17110",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Harrisburg"
                            },
                            {
                                "Zip":  "21776",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "New Windsor"
                            },
                            {
                                "Zip":  "46391",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Westville"
                            },
                            {
                                "Zip":  "60069",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Lincolnshire"
                            },
                            {
                                "Zip":  "71854",
                                "State":  "AR",
                                "Count":  1,
                                "City":  "Texarkana"
                            },
                            {
                                "Zip":  "94404",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Foster City"
                            },
                            {
                                "Zip":  "92407",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "San Bernardino"
                            },
                            {
                                "Zip":  "67505",
                                "State":  "KS",
                                "Count":  1,
                                "City":  "South Hutchinson"
                            },
                            {
                                "Zip":  "44095",
                                "State":  "OH",
                                "Count":  2,
                                "City":  "Eastlake"
                            },
                            {
                                "Zip":  "60517",
                                "State":  "IL",
                                "Count":  5,
                                "City":  "Woodridge"
                            },
                            {
                                "Zip":  "92870",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Placentia"
                            },
                            {
                                "Zip":  "53562",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Middleton"
                            },
                            {
                                "Zip":  "02720",
                                "State":  "MA",
                                "Count":  3,
                                "City":  "Fall River"
                            },
                            {
                                "Zip":  "98421",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Tacoma"
                            },
                            {
                                "Zip":  "46131",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Franklin"
                            },
                            {
                                "Zip":  "64020",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Concordia"
                            },
                            {
                                "Zip":  "30336",
                                "State":  "GA",
                                "Count":  4,
                                "City":  "Atlanta"
                            },
                            {
                                "Zip":  "85365",
                                "State":  "AZ",
                                "Count":  2,
                                "City":  "Yuma"
                            },
                            {
                                "Zip":  "43055",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Newark"
                            },
                            {
                                "Zip":  "40229",
                                "State":  "KY",
                                "Count":  2,
                                "City":  "Louisville"
                            },
                            {
                                "Zip":  "52404",
                                "State":  "IA",
                                "Count":  6,
                                "City":  "Cedar Rapids"
                            },
                            {
                                "Zip":  "84054",
                                "State":  "UT",
                                "Count":  2,
                                "City":  "North Salt Lake"
                            },
                            {
                                "Zip":  "32234",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Baldwin"
                            },
                            {
                                "Zip":  "48089",
                                "State":  "MI",
                                "Count":  6,
                                "City":  "Warren"
                            },
                            {
                                "Zip":  "21903",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Perryville"
                            },
                            {
                                "Zip":  "61802",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Urbana"
                            },
                            {
                                "Zip":  "88008",
                                "State":  "NM",
                                "Count":  1,
                                "City":  "Santa Teresa"
                            },
                            {
                                "Zip":  "35111",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "McCalla"
                            },
                            {
                                "Zip":  "63627",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Bloomsdale"
                            },
                            {
                                "Zip":  "74960",
                                "State":  "OK",
                                "Count":  1,
                                "City":  "Stilwell"
                            },
                            {
                                "Zip":  "43050",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Mount Vernon"
                            },
                            {
                                "Zip":  "45066",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Springboro"
                            },
                            {
                                "Zip":  "43207",
                                "State":  "OH",
                                "Count":  8,
                                "City":  "Columbus"
                            },
                            {
                                "Zip":  "49079",
                                "State":  "MI",
                                "Count":  2,
                                "City":  "Paw Paw"
                            },
                            {
                                "Zip":  "11722",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Central Islip"
                            },
                            {
                                "Zip":  "80022",
                                "State":  "CO",
                                "Count":  2,
                                "City":  "Commerce City"
                            },
                            {
                                "Zip":  "48162",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Monroe"
                            },
                            {
                                "Zip":  "53051",
                                "State":  "WI",
                                "Count":  5,
                                "City":  "Menomonee Falls"
                            },
                            {
                                "Zip":  "51501",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Council Bluffs"
                            },
                            {
                                "Zip":  "64836",
                                "State":  "MO",
                                "Count":  2,
                                "City":  "Carthage"
                            },
                            {
                                "Zip":  "62206",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Sauget"
                            },
                            {
                                "Zip":  "36251",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "Ashland"
                            },
                            {
                                "Zip":  "43207",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Obetz"
                            },
                            {
                                "Zip":  "99326",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Connell"
                            },
                            {
                                "Zip":  "60134",
                                "State":  "IL",
                                "Count":  4,
                                "City":  "Geneva"
                            },
                            {
                                "Zip":  "49048",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Kalamazoo"
                            },
                            {
                                "Zip":  "67901",
                                "State":  "KS",
                                "Count":  2,
                                "City":  "Liberal"
                            },
                            {
                                "Zip":  "21643",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Hurlock"
                            },
                            {
                                "Zip":  "S7P 0C7",
                                "State":  "SK-C",
                                "Count":  5,
                                "City":  "Saskatoon"
                            },
                            {
                                "Zip":  "93307",
                                "State":  "CA",
                                "Count":  11,
                                "City":  "Bakersfield"
                            },
                            {
                                "Zip":  "29210",
                                "State":  "SC",
                                "Count":  2,
                                "City":  "Columbia"
                            },
                            {
                                "Zip":  "72764",
                                "State":  "AR",
                                "Count":  2,
                                "City":  "Springdale"
                            },
                            {
                                "Zip":  "63114",
                                "State":  "MO",
                                "Count":  4,
                                "City":  "Saint Louis"
                            },
                            {
                                "Zip":  "55428",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Minneapolis"
                            },
                            {
                                "Zip":  "78218",
                                "State":  "TX",
                                "Count":  15,
                                "City":  "San Antonio"
                            },
                            {
                                "Zip":  "43749",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Kimbolton"
                            },
                            {
                                "Zip":  "20769",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Glenn Dale"
                            },
                            {
                                "Zip":  "42164",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "Scottsville"
                            },
                            {
                                "Zip":  "46507",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Bristol"
                            },
                            {
                                "Zip":  "73701",
                                "State":  "OK",
                                "Count":  2,
                                "City":  "Enid"
                            },
                            {
                                "Zip":  "53964",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Westfield"
                            },
                            {
                                "Zip":  "V3B 7Y6",
                                "State":  "BC-C",
                                "Count":  5,
                                "City":  "Port Coquitlam"
                            },
                            {
                                "Zip":  "72209",
                                "State":  "AR",
                                "Count":  1,
                                "City":  "Little Rock"
                            },
                            {
                                "Zip":  "30117",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Carrollton"
                            },
                            {
                                "Zip":  "50401",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Mason City"
                            },
                            {
                                "Zip":  "12065",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Clifton Park"
                            },
                            {
                                "Zip":  "45807",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Lima"
                            },
                            {
                                "Zip":  "84104",
                                "State":  "UT",
                                "Count":  4,
                                "City":  "Salt Lake City"
                            },
                            {
                                "Zip":  "37353",
                                "State":  "TN",
                                "Count":  2,
                                "City":  "McDonald"
                            },
                            {
                                "Zip":  "63401",
                                "State":  "MO",
                                "Count":  3,
                                "City":  "Hannibal"
                            },
                            {
                                "Zip":  "17601",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Lancaster"
                            },
                            {
                                "Zip":  "07305",
                                "State":  "NJ",
                                "Count":  1,
                                "City":  "Jersey City"
                            },
                            {
                                "Zip":  "54494",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "Wisconsin Rapids"
                            },
                            {
                                "Zip":  "75117",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Edgewood"
                            },
                            {
                                "Zip":  "M6R 2L2",
                                "State":  "ON-C",
                                "Count":  2,
                                "City":  "Toronto"
                            },
                            {
                                "Zip":  "53546",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Janesville"
                            },
                            {
                                "Zip":  "17353",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Orrtanna"
                            },
                            {
                                "Zip":  "75160",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Terrell"
                            },
                            {
                                "Zip":  "06423",
                                "State":  "CT",
                                "Count":  2,
                                "City":  "East Haddam"
                            },
                            {
                                "Zip":  "75605",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Longview"
                            },
                            {
                                "Zip":  "95620",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Dixon"
                            },
                            {
                                "Zip":  "18202",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Hazleton"
                            },
                            {
                                "Zip":  "92530",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Lake Elsinore"
                            },
                            {
                                "Zip":  "49420",
                                "State":  "MI",
                                "Count":  3,
                                "City":  "Hart"
                            },
                            {
                                "Zip":  "32256",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Jacksonville"
                            },
                            {
                                "Zip":  "75652",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Henderson"
                            },
                            {
                                "Zip":  "C0B 1M0",
                                "State":  "PE-C",
                                "Count":  1,
                                "City":  "New Annan"
                            },
                            {
                                "Zip":  "63801",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Sikeston"
                            },
                            {
                                "Zip":  "19963",
                                "State":  "DE",
                                "Count":  1,
                                "City":  "Milford"
                            },
                            {
                                "Zip":  "V3M 6G9",
                                "State":  "BC-C",
                                "Count":  4,
                                "City":  "Delta"
                            },
                            {
                                "Zip":  "36049",
                                "State":  "AL",
                                "Count":  3,
                                "City":  "Luverne"
                            },
                            {
                                "Zip":  "L7L 6M3",
                                "State":  "ON-C",
                                "Count":  2,
                                "City":  "Burlington"
                            },
                            {
                                "Zip":  "21157",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Westminster"
                            },
                            {
                                "Zip":  "44691",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Wooster"
                            },
                            {
                                "Zip":  "48116",
                                "State":  "MI",
                                "Count":  2,
                                "City":  "Brighton"
                            },
                            {
                                "Zip":  "20763",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Savage"
                            },
                            {
                                "Zip":  "65201",
                                "State":  "MO",
                                "Count":  4,
                                "City":  "Columbia"
                            },
                            {
                                "Zip":  "29720",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Lancaster"
                            },
                            {
                                "Zip":  "53931",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Fairwater"
                            },
                            {
                                "Zip":  "68462",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Waverly"
                            },
                            {
                                "Zip":  "47542",
                                "State":  "IN",
                                "Count":  2,
                                "City":  "Huntingburg"
                            },
                            {
                                "Zip":  "98948",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Toppenish"
                            },
                            {
                                "Zip":  "93245",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Lemoore"
                            },
                            {
                                "Zip":  "95240",
                                "State":  "CA",
                                "Count":  9,
                                "City":  "Lodi"
                            },
                            {
                                "Zip":  "79730",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Coyanosa"
                            },
                            {
                                "Zip":  "32351",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Quincy"
                            },
                            {
                                "Zip":  "R7A-7C9",
                                "State":  "MB-C",
                                "Count":  2,
                                "City":  "Brandon"
                            },
                            {
                                "Zip":  "92835",
                                "State":  "CA",
                                "Count":  9,
                                "City":  "Fullerton"
                            },
                            {
                                "Zip":  "33178",
                                "State":  "FL",
                                "Count":  3,
                                "City":  "Medley"
                            },
                            {
                                "Zip":  "30122",
                                "State":  "GA",
                                "Count":  4,
                                "City":  "Lithia Springs"
                            },
                            {
                                "Zip":  "53007",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Butler"
                            },
                            {
                                "Zip":  "19940",
                                "State":  "DE",
                                "Count":  8,
                                "City":  "Delmar"
                            },
                            {
                                "Zip":  "75904",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Lufkin"
                            },
                            {
                                "Zip":  "87121",
                                "State":  "NM",
                                "Count":  2,
                                "City":  "Albuquerque"
                            },
                            {
                                "Zip":  "32703",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Apopka"
                            },
                            {
                                "Zip":  "29702",
                                "State":  "SC",
                                "Count":  3,
                                "City":  "Blacksburg"
                            },
                            {
                                "Zip":  "46311",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Dyer"
                            },
                            {
                                "Zip":  "65265",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Mexico"
                            },
                            {
                                "Zip":  "90670",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Santa Fe Springs"
                            },
                            {
                                "Zip":  "06095",
                                "State":  "CT",
                                "Count":  2,
                                "City":  "Windsor"
                            },
                            {
                                "Zip":  "54140",
                                "State":  "WI",
                                "Count":  5,
                                "City":  "Little Chute"
                            },
                            {
                                "Zip":  "68731",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Dakota City"
                            },
                            {
                                "Zip":  "33411",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Royal Palm Beach"
                            },
                            {
                                "Zip":  "21050",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Forest Hill"
                            },
                            {
                                "Zip":  "T8H 2J6",
                                "State":  "AB-C",
                                "Count":  12,
                                "City":  "Sherwood Park"
                            },
                            {
                                "Zip":  "68661-0544",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Schuyler"
                            },
                            {
                                "Zip":  "19426",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Collegeville"
                            },
                            {
                                "Zip":  "35976",
                                "State":  "AL",
                                "Count":  3,
                                "City":  "Guntersville"
                            },
                            {
                                "Zip":  "54660",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "Tomah"
                            },
                            {
                                "Zip":  "33025",
                                "State":  "FL",
                                "Count":  3,
                                "City":  "Pembroke Pines"
                            },
                            {
                                "Zip":  "53538",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Fort Atkinson"
                            },
                            {
                                "Zip":  "53579",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Reeseville"
                            },
                            {
                                "Zip":  "30040",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Cumming"
                            },
                            {
                                "Zip":  "53956",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Randolph"
                            },
                            {
                                "Zip":  "15205",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Pittsburgh"
                            },
                            {
                                "Zip":  "29353",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Jonesville"
                            },
                            {
                                "Zip":  "76117",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Haltom City"
                            },
                            {
                                "Zip":  "53076",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Richfield"
                            },
                            {
                                "Zip":  "55336",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Glencoe"
                            },
                            {
                                "Zip":  "84404",
                                "State":  "UT",
                                "Count":  3,
                                "City":  "Ogden"
                            },
                            {
                                "Zip":  "47362",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "New Castle"
                            },
                            {
                                "Zip":  "35903",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "Gadsden"
                            },
                            {
                                "Zip":  "92243",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "El Centro"
                            },
                            {
                                "Zip":  "34221",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Palmetto"
                            },
                            {
                                "Zip":  "91706",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Baldwin Park"
                            },
                            {
                                "Zip":  "93618",
                                "State":  "CA",
                                "Count":  4,
                                "City":  "Dinuba"
                            },
                            {
                                "Zip":  "29340",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Gaffney"
                            },
                            {
                                "Zip":  "37072-1867",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Goodlettsville"
                            },
                            {
                                "Zip":  "55021",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Faribault"
                            },
                            {
                                "Zip":  "17516",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Conestoga"
                            },
                            {
                                "Zip":  "01085",
                                "State":  "MA",
                                "Count":  1,
                                "City":  "Westfield"
                            },
                            {
                                "Zip":  "54101",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Abrams"
                            },
                            {
                                "Zip":  "28328",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Clinton"
                            },
                            {
                                "Zip":  "33314",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Davie"
                            },
                            {
                                "Zip":  "95203",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Stockton"
                            },
                            {
                                "Zip":  "95356",
                                "State":  "CA",
                                "Count":  11,
                                "City":  "Modesto"
                            },
                            {
                                "Zip":  "49306",
                                "State":  "MI",
                                "Count":  2,
                                "City":  "Belmont"
                            },
                            {
                                "Zip":  "51041",
                                "State":  "IA",
                                "Count":  2,
                                "City":  "Orange City"
                            },
                            {
                                "Zip":  "03603",
                                "State":  "NH",
                                "Count":  1,
                                "City":  "Charlestown"
                            },
                            {
                                "Zip":  "54703",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Eau Claire"
                            },
                            {
                                "Zip":  "99006",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Deer Park"
                            },
                            {
                                "Zip":  "R3H 1H6",
                                "State":  "MB-C",
                                "Count":  2,
                                "City":  "Winnipeg"
                            },
                            {
                                "Zip":  "80550",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Windsor"
                            },
                            {
                                "Zip":  "49548",
                                "State":  "MI",
                                "Count":  3,
                                "City":  "Wyoming"
                            },
                            {
                                "Zip":  "S4N 5W5",
                                "State":  "SK-C",
                                "Count":  2,
                                "City":  "Regina"
                            },
                            {
                                "Zip":  "68748",
                                "State":  "NE",
                                "Count":  2,
                                "City":  "Madison"
                            },
                            {
                                "Zip":  "19154",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Philadelphia"
                            },
                            {
                                "Zip":  "75234",
                                "State":  "TX",
                                "Count":  3,
                                "City":  "Dallas"
                            },
                            {
                                "Zip":  "46241",
                                "State":  "IN",
                                "Count":  9,
                                "City":  "INDIANAPOLIS"
                            },
                            {
                                "Zip":  "94804",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Richmond"
                            },
                            {
                                "Zip":  "46072",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Tipton"
                            },
                            {
                                "Zip":  "60439",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Lemont"
                            },
                            {
                                "Zip":  "4108",
                                "State":  "QLD-A",
                                "Count":  3,
                                "City":  "Coopers Plains"
                            },
                            {
                                "Zip":  "T1H 5H8",
                                "State":  "AB-C",
                                "Count":  1,
                                "City":  "Lethbridge"
                            },
                            {
                                "Zip":  "50588",
                                "State":  "IA",
                                "Count":  2,
                                "City":  "Storm Lake"
                            },
                            {
                                "Zip":  "46776",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Orland"
                            },
                            {
                                "Zip":  "56379",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Sauk Rapids"
                            },
                            {
                                "Zip":  "19701",
                                "State":  "DE",
                                "Count":  3,
                                "City":  "Bear"
                            },
                            {
                                "Zip":  "18424",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Covington Township"
                            },
                            {
                                "Zip":  "14204",
                                "State":  "NY",
                                "Count":  4,
                                "City":  "Buffalo"
                            },
                            {
                                "Zip":  "78154",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Selma"
                            },
                            {
                                "Zip":  "30153",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Rockmart"
                            },
                            {
                                "Zip":  "63556",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Milan"
                            },
                            {
                                "Zip":  "89002",
                                "State":  "NV",
                                "Count":  2,
                                "City":  "Henderson"
                            },
                            {
                                "Zip":  "84321",
                                "State":  "UT",
                                "Count":  1,
                                "City":  "Logan"
                            },
                            {
                                "Zip":  "54448",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Marathon"
                            },
                            {
                                "Zip":  "28016",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Bessemer City"
                            },
                            {
                                "Zip":  "17268",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Waynesboro"
                            },
                            {
                                "Zip":  "53081",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Sheboygan"
                            },
                            {
                                "Zip":  "N6N 1N7",
                                "State":  "ON-C",
                                "Count":  7,
                                "City":  "London"
                            },
                            {
                                "Zip":  "47201",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Columbus"
                            },
                            {
                                "Zip":  "91730",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Rancho Cucamonga"
                            },
                            {
                                "Zip":  "27045",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Rural Hall"
                            },
                            {
                                "Zip":  "36089",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "Union Springs"
                            },
                            {
                                "Zip":  "93901",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Salinas"
                            },
                            {
                                "Zip":  "16635",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Duncansville"
                            },
                            {
                                "Zip":  "75941",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Diboll"
                            },
                            {
                                "Zip":  "56093",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Waseca"
                            },
                            {
                                "Zip":  "98005",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Bellevue"
                            },
                            {
                                "Zip":  "01001",
                                "State":  "MA",
                                "Count":  3,
                                "City":  "Agawam"
                            },
                            {
                                "Zip":  "18951",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Quakertown"
                            },
                            {
                                "Zip":  "58201",
                                "State":  "ND",
                                "Count":  1,
                                "City":  "Grand Forks"
                            },
                            {
                                "Zip":  "53114",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Darien"
                            },
                            {
                                "Zip":  "27017",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Dobson"
                            },
                            {
                                "Zip":  "28392",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Tar Heel"
                            },
                            {
                                "Zip":  "94607",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Oakland"
                            },
                            {
                                "Zip":  "33566",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Plant City"
                            },
                            {
                                "Zip":  "53121",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Elkhorn"
                            },
                            {
                                "Zip":  "75006",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Carrollton"
                            },
                            {
                                "Zip":  "39117",
                                "State":  "MS",
                                "Count":  2,
                                "City":  "Morton"
                            },
                            {
                                "Zip":  "L0P 1E0",
                                "State":  "ON-C",
                                "Count":  1,
                                "City":  "Hornby"
                            },
                            {
                                "Zip":  "75482",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Sulphur Springs"
                            },
                            {
                                "Zip":  "14737",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Franklinville"
                            },
                            {
                                "Zip":  "92841",
                                "State":  "CA",
                                "Count":  5,
                                "City":  "Garden Grove"
                            },
                            {
                                "Zip":  "51031",
                                "State":  "IA",
                                "Count":  5,
                                "City":  "Lemars"
                            },
                            {
                                "Zip":  "79108",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Amarillo"
                            },
                            {
                                "Zip":  "75056",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "LEWISVILLE"
                            },
                            {
                                "Zip":  "L7E 1E6",
                                "State":  "ON-C",
                                "Count":  3,
                                "City":  "Bolton"
                            },
                            {
                                "Zip":  "13476",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Vernon"
                            },
                            {
                                "Zip":  "53037",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Jackson"
                            },
                            {
                                "Zip":  "50211",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Norwalk"
                            },
                            {
                                "Zip":  "08012",
                                "State":  "NJ",
                                "Count":  1,
                                "City":  "Blackwood"
                            },
                            {
                                "Zip":  "70380",
                                "State":  "LA",
                                "Count":  1,
                                "City":  "Morgan City"
                            },
                            {
                                "Zip":  "93274",
                                "State":  "CA",
                                "Count":  5,
                                "City":  "Tulare"
                            },
                            {
                                "Zip":  "17059",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Mifflintown"
                            },
                            {
                                "Zip":  "67801",
                                "State":  "KS",
                                "Count":  2,
                                "City":  "Dodge City"
                            },
                            {
                                "Zip":  "37760",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Jefferson City"
                            },
                            {
                                "Zip":  "90241",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Downey"
                            },
                            {
                                "Zip":  "04039",
                                "State":  "ME",
                                "Count":  1,
                                "City":  "Gray"
                            },
                            {
                                "Zip":  "76504",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Temple"
                            },
                            {
                                "Zip":  "85353",
                                "State":  "AZ",
                                "Count":  3,
                                "City":  "Tolleson"
                            },
                            {
                                "Zip":  "05753",
                                "State":  "VT",
                                "Count":  1,
                                "City":  "Middlebury"
                            },
                            {
                                "Zip":  "64701",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Harrisonville"
                            },
                            {
                                "Zip":  "51442",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Denison"
                            },
                            {
                                "Zip":  "02878",
                                "State":  "RI",
                                "Count":  1,
                                "City":  "Tiverton"
                            },
                            {
                                "Zip":  "54421",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Colby"
                            },
                            {
                                "Zip":  "63043",
                                "State":  "MO",
                                "Count":  2,
                                "City":  "Maryland Heights"
                            },
                            {
                                "Zip":  "66111",
                                "State":  "KS",
                                "Count":  1,
                                "City":  "Edwardsville"
                            },
                            {
                                "Zip":  "17402",
                                "State":  "PA",
                                "Count":  5,
                                "City":  "York"
                            },
                            {
                                "Zip":  "28034",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Dallas"
                            },
                            {
                                "Zip":  "95837",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Sacramento"
                            },
                            {
                                "Zip":  "79925",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "El Paso"
                            },
                            {
                                "Zip":  "98168",
                                "State":  "WA",
                                "Count":  2,
                                "City":  "Tukwila"
                            },
                            {
                                "Zip":  "2795",
                                "State":  "NSW-A",
                                "Count":  1,
                                "City":  "Kelso"
                            },
                            {
                                "Zip":  "97448",
                                "State":  "OR",
                                "Count":  1,
                                "City":  "Junction City"
                            },
                            {
                                "Zip":  "29673",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Piedmont"
                            },
                            {
                                "Zip":  "60447",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Minooka"
                            },
                            {
                                "Zip":  "18964",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Souderton"
                            },
                            {
                                "Zip":  "48150",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Livonia"
                            },
                            {
                                "Zip":  "83687",
                                "State":  "ID",
                                "Count":  1,
                                "City":  "Nampa"
                            },
                            {
                                "Zip":  "28365",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Mount Olive"
                            },
                            {
                                "Zip":  "40965",
                                "State":  "KY",
                                "Count":  2,
                                "City":  "Middlesboro"
                            },
                            {
                                "Zip":  "08753",
                                "State":  "NJ",
                                "Count":  2,
                                "City":  "Toms River"
                            },
                            {
                                "Zip":  "68784",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Wakefield"
                            },
                            {
                                "Zip":  "54669",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "West Salem"
                            },
                            {
                                "Zip":  "14551",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Sodus"
                            },
                            {
                                "Zip":  "06051",
                                "State":  "CT",
                                "Count":  1,
                                "City":  "New Britain"
                            },
                            {
                                "Zip":  "35401",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Tuscaloosa"
                            },
                            {
                                "Zip":  "76225",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Alvord"
                            },
                            {
                                "Zip":  "21901",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "North East"
                            },
                            {
                                "Zip":  "28365",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Mt. Olive"
                            },
                            {
                                "Zip":  "30554",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Lula"
                            },
                            {
                                "Zip":  "07006",
                                "State":  "NJ",
                                "Count":  1,
                                "City":  "West Caldwell"
                            },
                            {
                                "Zip":  "94574",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Saint Helena"
                            },
                            {
                                "Zip":  "55337",
                                "State":  "MN",
                                "Count":  4,
                                "City":  "Burnsville"
                            },
                            {
                                "Zip":  "35601",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Decatur"
                            },
                            {
                                "Zip":  "80228",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Lakewood"
                            },
                            {
                                "Zip":  "22842",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Mount Jackson"
                            },
                            {
                                "Zip":  "46706",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Auburn"
                            },
                            {
                                "Zip":  "29445",
                                "State":  "SC",
                                "Count":  2,
                                "City":  "Goose Creek"
                            },
                            {
                                "Zip":  "K2S 1E7",
                                "State":  "ON-C",
                                "Count":  2,
                                "City":  "Stittsville"
                            },
                            {
                                "Zip":  "37160",
                                "State":  "TN",
                                "Count":  2,
                                "City":  "Shelbyville"
                            },
                            {
                                "Zip":  "30019",
                                "State":  "GA",
                                "Count":  2,
                                "City":  "Dacula"
                            },
                            {
                                "Zip":  "15650",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Latrobe"
                            },
                            {
                                "Zip":  "27530",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Goldsboro"
                            },
                            {
                                "Zip":  "20109",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Manassas"
                            },
                            {
                                "Zip":  "98233",
                                "State":  "WA",
                                "Count":  2,
                                "City":  "Burlington"
                            },
                            {
                                "Zip":  "80513",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Berthoud"
                            },
                            {
                                "Zip":  "78681",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Round Rock"
                            },
                            {
                                "Zip":  "47501",
                                "State":  "IN",
                                "Count":  3,
                                "City":  "Washington"
                            },
                            {
                                "Zip":  "35022",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Bessemer"
                            },
                            {
                                "Zip":  "77536",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Deer Park"
                            },
                            {
                                "Zip":  "98221",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "ANACORTES"
                            },
                            {
                                "Zip":  "92064",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Poway"
                            },
                            {
                                "Zip":  "61354",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Peru"
                            },
                            {
                                "Zip":  "30344",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "East Point"
                            },
                            {
                                "Zip":  "63026",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Fenton"
                            },
                            {
                                "Zip":  "J3V 0M7",
                                "State":  "QC-C",
                                "Count":  1,
                                "City":  "Saint-Bruno de Montarville"
                            },
                            {
                                "Zip":  "14420",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Brockport"
                            },
                            {
                                "Zip":  "68850",
                                "State":  "NE",
                                "Count":  1,
                                "City":  "Lexington"
                            },
                            {
                                "Zip":  "98682",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Vancouver"
                            },
                            {
                                "Zip":  "93960",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Soledad"
                            },
                            {
                                "Zip":  "98032",
                                "State":  "WA",
                                "Count":  2,
                                "City":  "Kent"
                            },
                            {
                                "Zip":  "38141",
                                "State":  "TN",
                                "Count":  4,
                                "City":  "Memphis"
                            },
                            {
                                "Zip":  "74873",
                                "State":  "OK",
                                "Count":  1,
                                "City":  "Tecumseh"
                            },
                            {
                                "Zip":  "01801",
                                "State":  "MA",
                                "Count":  1,
                                "City":  "Woburn"
                            },
                            {
                                "Zip":  "35045",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Clanton"
                            },
                            {
                                "Zip":  "29607",
                                "State":  "SC",
                                "Count":  4,
                                "City":  "Greenville"
                            },
                            {
                                "Zip":  "20794",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Jessup"
                            },
                            {
                                "Zip":  "80538",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Loveland"
                            },
                            {
                                "Zip":  "19438",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Harleysville"
                            },
                            {
                                "Zip":  "27302",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Mebane"
                            },
                            {
                                "Zip":  "54208",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Denmark"
                            },
                            {
                                "Zip":  "85282",
                                "State":  "AZ",
                                "Count":  1,
                                "City":  "Tempe"
                            },
                            {
                                "Zip":  "40741",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "London"
                            },
                            {
                                "Zip":  "54405",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "Abbotsford"
                            },
                            {
                                "Zip":  "60022",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Glencoe"
                            },
                            {
                                "Zip":  "30062",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Marietta"
                            },
                            {
                                "Zip":  "84339",
                                "State":  "UT",
                                "Count":  1,
                                "City":  "Wellsville"
                            },
                            {
                                "Zip":  "32055",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Lake City"
                            },
                            {
                                "Zip":  "90813",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Long Beach"
                            },
                            {
                                "Zip":  "64120",
                                "State":  "MO",
                                "Count":  2,
                                "City":  "Kansas City"
                            },
                            {
                                "Zip":  "42001",
                                "State":  "KY",
                                "Count":  1,
                                "City":  "Paducah"
                            },
                            {
                                "Zip":  "33334",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Oakland Park"
                            },
                            {
                                "Zip":  "T3M 2J9",
                                "State":  "AB-C",
                                "Count":  16,
                                "City":  "Calgary"
                            },
                            {
                                "Zip":  "46526",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Goshen"
                            },
                            {
                                "Zip":  "78754",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Austin"
                            },
                            {
                                "Zip":  "48917",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Lansing"
                            },
                            {
                                "Zip":  "16056",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Saxonburg"
                            },
                            {
                                "Zip":  "15205",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Pittsburg"
                            },
                            {
                                "Zip":  "54868",
                                "State":  "WI",
                                "Count":  3,
                                "City":  "Rice Lake"
                            },
                            {
                                "Zip":  "95050",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Santa Clara"
                            },
                            {
                                "Zip":  "28601",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Hickory"
                            },
                            {
                                "Zip":  "56347",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Long Prairie"
                            },
                            {
                                "Zip":  "19933",
                                "State":  "DE",
                                "Count":  2,
                                "City":  "Bridgeville"
                            },
                            {
                                "Zip":  "54911",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Appleton"
                            },
                            {
                                "Zip":  "29101",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "McBee"
                            },
                            {
                                "Zip":  "00001",
                                "State":  "CO-VA",
                                "Count":  1,
                                "City":  "Cali"
                            },
                            {
                                "Zip":  "80023",
                                "State":  "CO",
                                "Count":  3,
                                "City":  "Thornton"
                            },
                            {
                                "Zip":  "75150",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Mesquite"
                            },
                            {
                                "Zip":  "90040",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Commerce"
                            },
                            {
                                "Zip":  "28110",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Monroe"
                            },
                            {
                                "Zip":  "08028",
                                "State":  "NJ",
                                "Count":  1,
                                "City":  "Glassboro"
                            },
                            {
                                "Zip":  "33069",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Pompano Beach"
                            },
                            {
                                "Zip":  "30134",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Douglasville"
                            },
                            {
                                "Zip":  "17033",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Hershey"
                            },
                            {
                                "Zip":  "37060",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Eagleville"
                            },
                            {
                                "Zip":  "92227",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Brawley"
                            },
                            {
                                "Zip":  "18064",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Nazareth"
                            },
                            {
                                "Zip":  "77041",
                                "State":  "TX",
                                "Count":  8,
                                "City":  "Houston"
                            },
                            {
                                "Zip":  "85355",
                                "State":  "AZ",
                                "Count":  1,
                                "City":  "Waddell"
                            },
                            {
                                "Zip":  "60453",
                                "State":  "IL",
                                "Count":  2,
                                "City":  "Oak Lawn"
                            },
                            {
                                "Zip":  "35204",
                                "State":  "AL",
                                "Count":  2,
                                "City":  "Birmingham"
                            },
                            {
                                "Zip":  "60185",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "West Chicago"
                            },
                            {
                                "Zip":  "36618",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Mobile"
                            },
                            {
                                "Zip":  "27520",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Clayton"
                            },
                            {
                                "Zip":  "84333",
                                "State":  "UT",
                                "Count":  2,
                                "City":  "Richmond"
                            },
                            {
                                "Zip":  "6065",
                                "State":  "WA-A",
                                "Count":  1,
                                "City":  "Wangara"
                            },
                            {
                                "Zip":  "44846",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Milan"
                            },
                            {
                                "Zip":  "43739",
                                "State":  "OH",
                                "Count":  2,
                                "City":  "Glenford"
                            },
                            {
                                "Zip":  "30115",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Canton"
                            },
                            {
                                "Zip":  "31601",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Valdosta"
                            },
                            {
                                "Zip":  "80111",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Centennial"
                            },
                            {
                                "Zip":  "64504",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Saint Joseph"
                            },
                            {
                                "Zip":  "66215",
                                "State":  "KS",
                                "Count":  3,
                                "City":  "Lenexa"
                            },
                            {
                                "Zip":  "68601",
                                "State":  "NE",
                                "Count":  2,
                                "City":  "Columbus"
                            },
                            {
                                "Zip":  "60007",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Elk Grove Village"
                            },
                            {
                                "Zip":  "17067",
                                "State":  "PA",
                                "Count":  2,
                                "City":  "Myerstown"
                            },
                            {
                                "Zip":  "37210",
                                "State":  "TN",
                                "Count":  2,
                                "City":  "Nashville"
                            },
                            {
                                "Zip":  "23059",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Glen Allen"
                            },
                            {
                                "Zip":  "28358",
                                "State":  "NC",
                                "Count":  3,
                                "City":  "Lumberton"
                            },
                            {
                                "Zip":  "79035",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Friona"
                            },
                            {
                                "Zip":  "75706",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Tyler"
                            },
                            {
                                "Zip":  "45227",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Cincinnati"
                            },
                            {
                                "Zip":  "78572",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Mission"
                            },
                            {
                                "Zip":  "91710",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Chino"
                            },
                            {
                                "Zip":  "V1M2X7",
                                "State":  "BC-C",
                                "Count":  1,
                                "City":  "Langley"
                            },
                            {
                                "Zip":  "33070",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Tavernier"
                            },
                            {
                                "Zip":  "04622",
                                "State":  "ME",
                                "Count":  1,
                                "City":  "Cherryfield"
                            },
                            {
                                "Zip":  "56001",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Mankato"
                            },
                            {
                                "Zip":  "95020",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "Gilroy"
                            },
                            {
                                "Zip":  "60098",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Woodstock"
                            },
                            {
                                "Zip":  "53154",
                                "State":  "WI",
                                "Count":  2,
                                "City":  "Oak Creek"
                            },
                            {
                                "Zip":  "83318",
                                "State":  "ID",
                                "Count":  2,
                                "City":  "Burley"
                            },
                            {
                                "Zip":  "44857",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Norwalk"
                            },
                            {
                                "Zip":  "28645",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Lenoir"
                            },
                            {
                                "Zip":  "37303",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Athens"
                            },
                            {
                                "Zip":  "36108",
                                "State":  "AL",
                                "Count":  4,
                                "City":  "Montgomery"
                            },
                            {
                                "Zip":  "98225",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Bellingham"
                            },
                            {
                                "Zip":  "55912",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Austin"
                            },
                            {
                                "Zip":  "94080",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "South San Francisco"
                            },
                            {
                                "Zip":  "23301",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Accomac"
                            },
                            {
                                "Zip":  "19525",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Gilbertsville"
                            },
                            {
                                "Zip":  "43082",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Westerville"
                            },
                            {
                                "Zip":  "72901",
                                "State":  "AR",
                                "Count":  3,
                                "City":  "Fort Smith"
                            },
                            {
                                "Zip":  "98595",
                                "State":  "WA",
                                "Count":  2,
                                "City":  "Westport"
                            },
                            {
                                "Zip":  "28711",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Black Mountain"
                            },
                            {
                                "Zip":  "98520",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Aberdeen"
                            },
                            {
                                "Zip":  "02359",
                                "State":  "MA",
                                "Count":  1,
                                "City":  "Pembroke"
                            },
                            {
                                "Zip":  "02910",
                                "State":  "RI",
                                "Count":  1,
                                "City":  "Cranston"
                            },
                            {
                                "Zip":  "19507",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Bethel"
                            },
                            {
                                "Zip":  "63042",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Hazelwood"
                            },
                            {
                                "Zip":  "83709",
                                "State":  "ID",
                                "Count":  1,
                                "City":  "Boise"
                            },
                            {
                                "Zip":  "49431",
                                "State":  "MI",
                                "Count":  1,
                                "City":  "Ludington"
                            },
                            {
                                "Zip":  "99344",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Othello"
                            },
                            {
                                "Zip":  "19440",
                                "State":  "PA",
                                "Count":  3,
                                "City":  "Hatfield"
                            },
                            {
                                "Zip":  "80601",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Brighton"
                            },
                            {
                                "Zip":  "37167",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Smyrna"
                            },
                            {
                                "Zip":  "17011",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Camp Hill"
                            },
                            {
                                "Zip":  "75020",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Denison"
                            },
                            {
                                "Zip":  "44010",
                                "State":  "OH",
                                "Count":  1,
                                "City":  "Austinburg"
                            },
                            {
                                "Zip":  "22603",
                                "State":  "VA",
                                "Count":  1,
                                "City":  "Winchester"
                            },
                            {
                                "Zip":  "37127",
                                "State":  "TN",
                                "Count":  2,
                                "City":  "Murfreesboro"
                            },
                            {
                                "Zip":  "90058",
                                "State":  "CA",
                                "Count":  4,
                                "City":  "Vernon"
                            },
                            {
                                "Zip":  "89178",
                                "State":  "NV",
                                "Count":  2,
                                "City":  "Las Vegas"
                            },
                            {
                                "Zip":  "04786",
                                "State":  "ME",
                                "Count":  1,
                                "City":  "Washburn"
                            },
                            {
                                "Zip":  "N4B 1Z9",
                                "State":  "ON-C",
                                "Count":  1,
                                "City":  "Delhi"
                            },
                            {
                                "Zip":  "29127",
                                "State":  "SC",
                                "Count":  1,
                                "City":  "Prosperity"
                            },
                            {
                                "Zip":  "12010",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Amsterdam"
                            },
                            {
                                "Zip":  "78154",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Schertz"
                            },
                            {
                                "Zip":  "78852",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Eagle Pass"
                            },
                            {
                                "Zip":  "49464",
                                "State":  "MI",
                                "Count":  3,
                                "City":  "Zeeland"
                            },
                            {
                                "Zip":  "98903",
                                "State":  "WA",
                                "Count":  3,
                                "City":  "Yakima"
                            },
                            {
                                "Zip":  "80107",
                                "State":  "CO",
                                "Count":  1,
                                "City":  "Elizabeth"
                            },
                            {
                                "Zip":  "B4N 3X3",
                                "State":  "NS-C",
                                "Count":  1,
                                "City":  "Kentville"
                            },
                            {
                                "Zip":  "53066",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Oconomowoc"
                            },
                            {
                                "Zip":  "82009",
                                "State":  "WY",
                                "Count":  2,
                                "City":  "Cheyenne"
                            },
                            {
                                "Zip":  "55112",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "New Brighton"
                            },
                            {
                                "Zip":  "32822",
                                "State":  "FL",
                                "Count":  3,
                                "City":  "Orlando"
                            },
                            {
                                "Zip":  "95023",
                                "State":  "CA",
                                "Count":  1,
                                "City":  "Hollister"
                            },
                            {
                                "Zip":  "99518",
                                "State":  "AK",
                                "Count":  1,
                                "City":  "Anchorage"
                            },
                            {
                                "Zip":  "28216",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Charlotte"
                            },
                            {
                                "Zip":  "39209",
                                "State":  "MS",
                                "Count":  1,
                                "City":  "Jackson"
                            },
                            {
                                "Zip":  "60491",
                                "State":  "IL",
                                "Count":  6,
                                "City":  "Homer Glen"
                            },
                            {
                                "Zip":  "65802-6228",
                                "State":  "MO",
                                "Count":  5,
                                "City":  "Springfield"
                            },
                            {
                                "Zip":  "55317",
                                "State":  "MN",
                                "Count":  1,
                                "City":  "Chanhassen"
                            },
                            {
                                "Zip":  "21031",
                                "State":  "MD",
                                "Count":  1,
                                "City":  "Hunt Valley"
                            },
                            {
                                "Zip":  "98816",
                                "State":  "WA",
                                "Count":  2,
                                "City":  "Chelan"
                            },
                            {
                                "Zip":  "28658",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Newton"
                            },
                            {
                                "Zip":  "79401",
                                "State":  "TX",
                                "Count":  2,
                                "City":  "Lubbock"
                            },
                            {
                                "Zip":  "98275",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Mukilteo"
                            },
                            {
                                "Zip":  "97055",
                                "State":  "OR",
                                "Count":  1,
                                "City":  "Sandy"
                            },
                            {
                                "Zip":  "95076",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Watsonville"
                            },
                            {
                                "Zip":  "90630",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Cypress"
                            },
                            {
                                "Zip":  "59101",
                                "State":  "MT",
                                "Count":  1,
                                "City":  "Billings"
                            },
                            {
                                "Zip":  "14624",
                                "State":  "NY",
                                "Count":  1,
                                "City":  "Rochester"
                            },
                            {
                                "Zip":  "77379",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Spring"
                            },
                            {
                                "Zip":  "19030",
                                "State":  "PA",
                                "Count":  10,
                                "City":  "Fairless Hills"
                            },
                            {
                                "Zip":  "50423",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Britt"
                            },
                            {
                                "Zip":  "92618",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Irvine"
                            },
                            {
                                "Zip":  "43701",
                                "State":  "OH",
                                "Count":  2,
                                "City":  "Zanesville"
                            },
                            {
                                "Zip":  "79013",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Cactus"
                            },
                            {
                                "Zip":  "98047",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Pacific"
                            },
                            {
                                "Zip":  "55318",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Chaska"
                            },
                            {
                                "Zip":  "50313",
                                "State":  "IA",
                                "Count":  3,
                                "City":  "Des Moines"
                            },
                            {
                                "Zip":  "56438",
                                "State":  "MN",
                                "Count":  2,
                                "City":  "Browerville"
                            },
                            {
                                "Zip":  "54437",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Greenwood"
                            },
                            {
                                "Zip":  "99336",
                                "State":  "WA",
                                "Count":  4,
                                "City":  "Kennewick"
                            },
                            {
                                "Zip":  "99216",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Spokane Valley"
                            },
                            {
                                "Zip":  "91789",
                                "State":  "CA",
                                "Count":  5,
                                "City":  "Walnut"
                            },
                            {
                                "Zip":  "97501",
                                "State":  "OR",
                                "Count":  1,
                                "City":  "Medford"
                            },
                            {
                                "Zip":  "95304",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Tracy"
                            },
                            {
                                "Zip":  "66607",
                                "State":  "KS",
                                "Count":  2,
                                "City":  "Topeka"
                            },
                            {
                                "Zip":  "80701",
                                "State":  "CO",
                                "Count":  2,
                                "City":  "Fort Morgan"
                            },
                            {
                                "Zip":  "33823",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Auburndale"
                            },
                            {
                                "Zip":  "27849",
                                "State":  "NC",
                                "Count":  2,
                                "City":  "Lewiston"
                            },
                            {
                                "Zip":  "27607",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Raleigh"
                            },
                            {
                                "Zip":  "53090",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "West Bend"
                            },
                            {
                                "Zip":  "33881",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Winter Haven"
                            },
                            {
                                "Zip":  "98531",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Centralia"
                            },
                            {
                                "Zip":  "54303",
                                "State":  "WI",
                                "Count":  5,
                                "City":  "Green Bay"
                            },
                            {
                                "Zip":  "32009",
                                "State":  "FL",
                                "Count":  1,
                                "City":  "Bryceville"
                            },
                            {
                                "Zip":  "72501",
                                "State":  "AR",
                                "Count":  2,
                                "City":  "Batesville"
                            },
                            {
                                "Zip":  "06074",
                                "State":  "CT",
                                "Count":  2,
                                "City":  "South Windsor"
                            },
                            {
                                "Zip":  "B2Y 2N1",
                                "State":  "NS-C",
                                "Count":  1,
                                "City":  "Dartmouth"
                            },
                            {
                                "Zip":  "76180",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "North Richland Hills"
                            },
                            {
                                "Zip":  "28384",
                                "State":  "NC",
                                "Count":  1,
                                "City":  "Saint Pauls"
                            },
                            {
                                "Zip":  "30542",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Flowery Branch"
                            },
                            {
                                "Zip":  "65251",
                                "State":  "MO",
                                "Count":  1,
                                "City":  "Fulton"
                            },
                            {
                                "Zip":  "05673",
                                "State":  "VT",
                                "Count":  1,
                                "City":  "Cabot"
                            },
                            {
                                "Zip":  "30121",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "Cartersville"
                            },
                            {
                                "Zip":  "95691",
                                "State":  "CA",
                                "Count":  3,
                                "City":  "West Sacramento"
                            },
                            {
                                "Zip":  "36207",
                                "State":  "AL",
                                "Count":  1,
                                "City":  "Anniston"
                            },
                            {
                                "Zip":  "83642",
                                "State":  "ID",
                                "Count":  1,
                                "City":  "Meridian"
                            },
                            {
                                "Zip":  "T5B 4H2",
                                "State":  "AB-C",
                                "Count":  4,
                                "City":  "Edmonton"
                            },
                            {
                                "Zip":  "95448",
                                "State":  "CA",
                                "Count":  2,
                                "City":  "Healdsburg"
                            },
                            {
                                "Zip":  "V1Y 7L8",
                                "State":  "BC-C",
                                "Count":  1,
                                "City":  "Kelowna"
                            },
                            {
                                "Zip":  "80010",
                                "State":  "CO",
                                "Count":  7,
                                "City":  "Aurora"
                            },
                            {
                                "Zip":  "62422",
                                "State":  "IL",
                                "Count":  1,
                                "City":  "Cowden"
                            },
                            {
                                "Zip":  "36827",
                                "State":  "GT-M",
                                "Count":  1,
                                "City":  "IRAPUATO"
                            },
                            {
                                "Zip":  "59808",
                                "State":  "MT",
                                "Count":  1,
                                "City":  "Missoula"
                            },
                            {
                                "Zip":  "78503",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "McAllen"
                            },
                            {
                                "Zip":  "22801",
                                "State":  "VA",
                                "Count":  7,
                                "City":  "Harrisonburg"
                            },
                            {
                                "Zip":  "18360",
                                "State":  "PA",
                                "Count":  1,
                                "City":  "Stroudsburg"
                            },
                            {
                                "Zip":  "98937",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Naches"
                            },
                            {
                                "Zip":  "38559",
                                "State":  "TN",
                                "Count":  1,
                                "City":  "Doyle"
                            },
                            {
                                "Zip":  "50213",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Osceola"
                            },
                            {
                                "Zip":  "46818",
                                "State":  "IN",
                                "Count":  11,
                                "City":  "Fort Wayne"
                            },
                            {
                                "Zip":  "33905",
                                "State":  "FL",
                                "Count":  2,
                                "City":  "Fort Myers"
                            },
                            {
                                "Zip":  "30233",
                                "State":  "GA",
                                "Count":  2,
                                "City":  "Jackson"
                            },
                            {
                                "Zip":  "47909",
                                "State":  "IN",
                                "Count":  1,
                                "City":  "Lafayette"
                            },
                            {
                                "Zip":  "76020",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Azle"
                            },
                            {
                                "Zip":  "71852",
                                "State":  "AR",
                                "Count":  1,
                                "City":  "Nashville"
                            },
                            {
                                "Zip":  "52002",
                                "State":  "IA",
                                "Count":  1,
                                "City":  "Dubuque"
                            },
                            {
                                "Zip":  "53042",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Kiel"
                            },
                            {
                                "Zip":  "72117",
                                "State":  "AR",
                                "Count":  3,
                                "City":  "North Little Rock"
                            },
                            {
                                "Zip":  "98424",
                                "State":  "WA",
                                "Count":  1,
                                "City":  "Fife"
                            },
                            {
                                "Zip":  "51450",
                                "State":  "IA",
                                "Count":  2,
                                "City":  "Lake View"
                            },
                            {
                                "Zip":  "85193",
                                "State":  "AZ",
                                "Count":  1,
                                "City":  "Casa Grande"
                            },
                            {
                                "Zip":  "53048",
                                "State":  "WI",
                                "Count":  1,
                                "City":  "Lomira"
                            },
                            {
                                "Zip":  "30253",
                                "State":  "GA",
                                "Count":  1,
                                "City":  "McDonough"
                            },
                            {
                                "Zip":  "78541",
                                "State":  "TX",
                                "Count":  1,
                                "City":  "Edinburg"
                            },
                            {
                                "Zip":  "G9A 5E1",
                                "State":  "QC-C",
                                "Count":  1,
                                "City":  "Trois-Rivieres"
                            }
                        ]
};

        // Load data from file or embedded
        async function loadData() {
            try {
                // Try to load from file first
                const response = await fetch('data/dashboard-data.json?' + Date.now());
                DATA = await response.json();
            } catch (e) {
                console.log('Loading from embedded data...');
                // Embedded data will be here if generated
            }
            if (DATA) {
                initDashboard();
            } else {
                document.getElementById('timestamp').textContent = 'Error: No data available. Run generate-dashboard.ps1';
            }
        }

        const stateCoords = {
            'AL':[32.8,-86.8],'AK':[61.4,-152.4],'AZ':[33.7,-111.4],'AR':[35,-92.4],'CA':[36.1,-119.7],
            'CO':[39.1,-105.3],'CT':[41.6,-72.8],'DE':[39.3,-75.5],'FL':[27.8,-81.7],'GA':[33,-83.6],
            'HI':[21.1,-157.5],'ID':[44.2,-114.5],'IL':[40.3,-89],'IN':[39.8,-86.3],'IA':[42,-93.2],
            'KS':[38.5,-96.7],'KY':[37.7,-84.7],'LA':[31.2,-91.9],'ME':[44.7,-69.4],'MD':[39.1,-76.8],
            'MA':[42.2,-71.5],'MI':[43.3,-84.5],'MN':[45.7,-93.9],'MS':[32.7,-89.7],'MO':[38.5,-92.3],
            'MT':[46.9,-110.5],'NE':[41.1,-98.3],'NV':[38.3,-117.1],'NH':[43.5,-71.6],'NJ':[40.3,-74.5],
            'NM':[34.8,-106.2],'NY':[42.2,-75],'NC':[35.6,-79.8],'ND':[47.5,-99.8],'OH':[40.4,-82.8],
            'OK':[35.6,-96.9],'OR':[44.6,-122.1],'PA':[40.6,-77.2],'RI':[41.7,-71.5],'SC':[33.9,-80.9],
            'SD':[44.3,-99.4],'TN':[35.7,-86.7],'TX':[31.1,-97.6],'UT':[40.2,-111.9],'VT':[44,-72.7],
            'VA':[37.8,-78.2],'WA':[47.4,-121.5],'WV':[38.5,-81],'WI':[44.3,-89.6],'WY':[42.8,-107.3]
        };
        
        // State name to abbreviation mapping (Salesforce returns full names)
        const stateNameToAbbr = {
            'Alabama':'AL','Alaska':'AK','Arizona':'AZ','Arkansas':'AR','California':'CA','CA':'CA',
            'Colorado':'CO','Connecticut':'CT','Delaware':'DE','Florida':'FL','Georgia':'GA',
            'Hawaii':'HI','Idaho':'ID','Illinois':'IL','Indiana':'IN','Iowa':'IA',
            'Kansas':'KS','Kentucky':'KY','Louisiana':'LA','Maine':'ME','Maryland':'MD',
            'Massachusetts':'MA','Michigan':'MI','Minnesota':'MN','Mississippi':'MS','Missouri':'MO',
            'Montana':'MT','Nebraska':'NE','Nevada':'NV','New Hampshire':'NH','New Jersey':'NJ',
            'New Mexico':'NM','New York':'NY','North Carolina':'NC','North Dakota':'ND','Ohio':'OH',
            'Oklahoma':'OK','Oregon':'OR','Pennsylvania':'PA','Rhode Island':'RI','South Carolina':'SC',
            'South Dakota':'SD','Tennessee':'TN','Texas':'TX','Utah':'UT','Vermont':'VT',
            'Virginia':'VA','Washington':'WA','West Virginia':'WV','Wisconsin':'WI','Wyoming':'WY',
            // Also include abbreviations as-is
            'AL':'AL','AK':'AK','AZ':'AZ','AR':'AR','CO':'CO','CT':'CT','DE':'DE','FL':'FL','GA':'GA',
            'HI':'HI','ID':'ID','IL':'IL','IN':'IN','IA':'IA','KS':'KS','KY':'KY','LA':'LA','ME':'ME',
            'MD':'MD','MA':'MA','MI':'MI','MN':'MN','MS':'MS','MO':'MO','MT':'MT','NE':'NE','NV':'NV',
            'NH':'NH','NJ':'NJ','NM':'NM','NY':'NY','NC':'NC','ND':'ND','OH':'OH','OK':'OK','OR':'OR',
            'PA':'PA','RI':'RI','SC':'SC','SD':'SD','TN':'TN','TX':'TX','UT':'UT','VT':'VT','VA':'VA',
            'WA':'WA','WV':'WV','WI':'WI','WY':'WY'
        };
        
        function getStateAbbr(state) {
            if (!state) return null;
            return stateNameToAbbr[state] || stateNameToAbbr[state.trim()] || null;
        }

        function fmt(n) { return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0}).format(n||0); }
        function fmtK(n) { return '$' + (n/1000).toFixed(0) + 'k'; }
        function fmtCompact(n) { 
            if (n >= 1000000) return '$' + (n/1000000).toFixed(1) + 'M';
            if (n >= 100000) return '$' + (n/1000).toFixed(0) + 'K';
            if (n >= 1000) return '$' + Math.round(n/1000) + 'K';
            return '$' + Math.round(n);
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav a').forEach(a => a.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            if (pageId === 'geography') setTimeout(initMap, 100);
            if (pageId === 'sales') setTimeout(initSalesPage, 100);
            if (pageId === 'ar') setTimeout(initARPage, 100);
            if (pageId === 'pnl') setTimeout(initPnLPage, 100);
        }

        function renderList(id, items, nameField='Name') {
            const el = document.getElementById(id);
            if (!items?.length) { el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No data</div>'; return; }
            const isProduct = nameField === 'Item';
            el.innerHTML = items.map((item,i) => {
                const rank = i<3 ? ['gold','silver','bronze'][i] : '';
                const name = item[nameField] || item.Name || item.Item || '?';
                const drilldownType = isProduct ? 'product' : 'customer';
                const itemData = JSON.stringify(item).replace(/"/g, '&quot;');
                return `<div class="top-item clickable" onclick="showDrilldown('${drilldownType}', ${itemData})" style="cursor:pointer;"><div class="rank ${rank}">${i+1}</div><div class="name" title="${name}">${name.substring(0,40)}</div><div class="amount">${fmt(item.Amount)}</div></div>`;
            }).join('');
        }

        function renderSalespersonList(id, items, showBreakdown = false, showTerritory = false) {
            const el = document.getElementById(id);
            if (!items?.length) { el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No data</div>'; return; }
            el.innerHTML = items.map((item,i) => {
                const rank = i<3 ? ['gold','silver','bronze'][i] : '';
                const invoices = item.InvoiceCount ? ` (${item.InvoiceCount} inv)` : '';
                const role = item.Role ? `<span style="font-size:11px;color:var(--text-secondary);background:rgba(255,255,255,0.1);padding:2px 6px;border-radius:4px;margin-left:8px;">${item.Role}</span>` : '';
                const breakdown = showBreakdown && (item.ProductAmount || item.ServiceAmount) ? 
                    `<div style="font-size:11px;color:var(--text-secondary);margin-top:4px;">
                        <span style="color:#4ecdc4;">Product: ${fmt(item.ProductAmount || 0)}</span> - 
                        <span style="color:#ff6b6b;">Service: ${fmt(item.ServiceAmount || 0)}</span>
                    </div>` : '';
                const territory = showTerritory && (item.StateCount || item.CityCount) ?
                    `<div style="font-size:11px;color:var(--warning);margin-top:4px;">
                        ${item.StateCount || 0} states - ${item.CityCount || 0} locations
                        ${item.States ? `<div style="font-size:10px;color:var(--text-secondary);margin-top:2px;">${item.States}</div>` : ''}
                    </div>` : '';
                // Service rep specific metrics
                const avgTicket = item.InvoiceCount > 0 ? item.Amount / item.InvoiceCount : 0;
                const svcPct = item.Amount > 0 ? ((item.ServiceAmount || 0) / item.Amount * 100).toFixed(0) : 0;
                const serviceMetrics = showTerritory && item.Role === 'Service Rep' && item.InvoiceCount > 0 ?
                    `<div style="font-size:11px;margin-top:6px;padding-top:6px;border-top:1px solid rgba(255,255,255,0.1);">
                        <span style="color:var(--success);">Avg/Call: ${fmt(avgTicket)}</span> - 
                        <span style="color:#a29bfe;">Labor: ${svcPct}%</span>
                    </div>` : '';
                const itemData = JSON.stringify(item).replace(/"/g, '&quot;');
                return `<div class="salesperson-card clickable" onclick="showDrilldown('salesperson', ${itemData})" style="cursor:pointer;">
                    <div>
                        <div class="name">${item.Name || 'Unknown'}${role}</div>
                        <div class="invoices">${invoices}</div>
                        ${breakdown}
                        ${territory}
                        ${serviceMetrics}
                    </div>
                    <div class="amount">${fmt(item.Amount)}</div>
                </div>`;
            }).join('');
        }

        function renderFieldTechList(id, techs) {
            const el = document.getElementById(id);
            if (!techs?.length) { el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No data</div>'; return; }
            
            // Sort by appointments descending
            const sorted = [...techs].sort((a,b) => (b.AppointmentsMTD || 0) - (a.AppointmentsMTD || 0));
            const leads = sorted.filter(t => t.IsLead);
            const others = sorted.filter(t => !t.IsLead);
            
            let html = '<div style="margin-bottom:15px;"><div style="font-weight:600;color:var(--warning);margin-bottom:8px;">â­ Tech Leads</div>';
            html += leads.map((t, i) => `
                <div class="top-item" style="border-left:3px solid var(--warning);">
                    <div class="name">${t.Name}</div>
                    <div style="display:flex;gap:15px;align-items:center;">
                        <span style="color:var(--success);font-weight:600;">${t.AppointmentsMTD || 0} appts</span>
                        <span style="color:var(--text-secondary);font-size:11px;">${t.StateCount || 0} states</span>
                    </div>
                </div>
            `).join('');
            html += '</div>';
            
            html += `<div><div style="font-weight:600;color:var(--text-secondary);margin-bottom:8px;">Field Technicians (${others.length})</div>`;
            html += others.map((t, i) => {
                const rank = i < 3 ? ['gold','silver','bronze'][i] : '';
                return `
                <div class="top-item">
                    <div class="rank ${rank}">${i+1}</div>
                    <div class="name" title="${t.StatesCovered || 'No states'}">${t.Name}</div>
                    <div style="display:flex;gap:15px;align-items:center;">
                        <span style="color:var(--success);font-weight:600;">${t.AppointmentsMTD || 0}</span>
                        <span style="color:var(--text-secondary);font-size:11px;">${t.StateCount || 0} st</span>
                    </div>
                </div>`;
            }).join('');
            html += '</div>';
            
            el.innerHTML = html;
        }

        function renderServiceStates(id, teamData) {
            const el = document.getElementById(id);
            if (!teamData?.length) { el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No data</div>'; return; }
            
            // Aggregate states from all team members who do service work
            const stateAmounts = {};
            teamData.forEach(member => {
                const states = (member.States || '').split(', ').filter(s => s);
                const svcAmount = member.ServiceAmount || 0;
                if (svcAmount > 0 && states.length > 0) {
                    const perState = svcAmount / states.length;
                    states.forEach(state => {
                        if (!stateAmounts[state]) stateAmounts[state] = { revenue: 0, count: 0 };
                        stateAmounts[state].revenue += perState;
                        stateAmounts[state].count++;
                    });
                }
            });
            
            const sorted = Object.entries(stateAmounts).sort((a,b) => b[1].revenue - a[1].revenue).slice(0, 20);
            
            if (sorted.length === 0) {
                el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No service state data available</div>';
                return;
            }
            
            el.innerHTML = sorted.map(([state, data], i) => {
                const rank = i < 3 ? ['gold','silver','bronze'][i] : '';
                return `<div class="top-item">
                    <div class="rank ${rank}">${i+1}</div>
                    <div class="name">${state}</div>
                    <div class="amount">${fmt(data.revenue)}</div>
                </div>`;
            }).join('');
        }

        function renderServiceStatesFromTechs(id, techs) {
            const el = document.getElementById(id);
            if (!techs?.length) { el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No data</div>'; return; }
            
            // Aggregate states from field tech data
            const stateAppts = {};
            techs.forEach(tech => {
                const details = tech.StatesDetail || [];
                details.forEach(d => {
                    if (d.State) {
                        if (!stateAppts[d.State]) stateAppts[d.State] = { appts: 0, techs: new Set() };
                        stateAppts[d.State].appts += d.Count || 0;
                        stateAppts[d.State].techs.add(tech.Name);
                    }
                });
            });
            
            const sorted = Object.entries(stateAppts).sort((a,b) => b[1].appts - a[1].appts).slice(0, 25);
            
            if (sorted.length === 0) {
                el.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">No service state data from Salesforce</div>';
                return;
            }
            
            el.innerHTML = sorted.map(([state, data], i) => {
                const rank = i < 3 ? ['gold','silver','bronze'][i] : '';
                const techCount = data.techs.size;
                return `<div class="top-item">
                    <div class="rank ${rank}">${i+1}</div>
                    <div class="name">${state}</div>
                    <div style="display:flex;gap:10px;align-items:center;">
                        <span style="color:var(--success);font-weight:600;">${data.appts} appts</span>
                        <span style="color:var(--text-secondary);font-size:11px;">${techCount} tech${techCount > 1 ? 's' : ''}</span>
                    </div>
                </div>`;
            }).join('');
        }

        let charts = {};

        function initDashboard() {
            document.getElementById('timestamp').textContent = `Updated: ${DATA.GeneratedAt}`;
            
            // KPIs
            document.getElementById('kpiYesterday').textContent = fmt(DATA.Summary.Yesterday.Total);
            document.getElementById('kpiMTD').textContent = fmt(DATA.Summary.MTD.Total);
            document.getElementById('kpiYTD').textContent = fmt(DATA.Summary.YTD.Total);
            document.getElementById('kpiAR').textContent = fmt(DATA.ARaging?.Total || 0);

            // Yesterday
            document.getElementById('yesterdayTotal').textContent = fmt(DATA.Summary.Yesterday.Total);
            document.getElementById('yesterdayDate').textContent = DATA.Period.Yesterday;
            document.getElementById('yProduct').textContent = fmt(DATA.Summary.Yesterday.Product);
            document.getElementById('yService').textContent = fmt(DATA.Summary.Yesterday.Service);
            document.getElementById('yFreight').textContent = fmt(DATA.Summary.Yesterday.Freight);
            document.getElementById('yMisc').textContent = fmt(DATA.Summary.Yesterday.Miscellaneous);

            // Averages
            document.getElementById('mtdAvg').textContent = fmt(DATA.Summary.MTDDailyAverage);
            document.getElementById('ytdAvg').textContent = fmt(DATA.Summary.YTDDailyAverage);
            document.getElementById('mtdDays').textContent = DATA.Period.MTDBusinessDays;
            document.getElementById('ytdDays').textContent = DATA.Period.YTDBusinessDays;

            // AR Aging
            if (DATA.ARaging) {
                document.getElementById('arCurrent').textContent = fmtCompact(DATA.ARaging.Current);
                document.getElementById('ar30').textContent = fmtCompact(DATA.ARaging.Days1_30);
                document.getElementById('ar60').textContent = fmtCompact(DATA.ARaging.Days31_60);
                document.getElementById('ar90').textContent = fmtCompact(DATA.ARaging.Days61_90);
                document.getElementById('ar90plus').textContent = fmtCompact(DATA.ARaging.Days90Plus);
                
                // Add click handlers for AR buckets
                document.getElementById('arCurrentCard').onclick = () => showDrilldown('ar-bucket', {name:'Current', amount:DATA.ARaging.Current, desc:'Invoices not yet due - payment expected within terms'});
                document.getElementById('ar30Card').onclick = () => showDrilldown('ar-bucket', {name:'1-30 Days', amount:DATA.ARaging.Days1_30, desc:'Invoices 1-30 days past due - send reminder notice'});
                document.getElementById('ar60Card').onclick = () => showDrilldown('ar-bucket', {name:'31-60 Days', amount:DATA.ARaging.Days31_60, desc:'Invoices 31-60 days past due - phone call recommended'});
                document.getElementById('ar90Card').onclick = () => showDrilldown('ar-bucket', {name:'61-90 Days', amount:DATA.ARaging.Days61_90, desc:'Invoices 61-90 days past due - escalate to management'});
                document.getElementById('ar90plusCard').onclick = () => showDrilldown('ar-bucket', {name:'90+ Days', amount:DATA.ARaging.Days90Plus, desc:'Invoices over 90 days past due - requires immediate attention'});
            }
            
            // Add click handlers for category breakdown
            const yTotal = DATA.Summary.Yesterday.Total || 1;
            document.getElementById('yProductCard').onclick = () => showDrilldown('category', {name:'Product', amount:DATA.Summary.Yesterday.Product, pct:((DATA.Summary.Yesterday.Product/yTotal)*100).toFixed(1)});
            document.getElementById('yServiceCard').onclick = () => showDrilldown('category', {name:'Service', amount:DATA.Summary.Yesterday.Service, pct:((DATA.Summary.Yesterday.Service/yTotal)*100).toFixed(1)});
            document.getElementById('yFreightCard').onclick = () => showDrilldown('category', {name:'Freight', amount:DATA.Summary.Yesterday.Freight, pct:((DATA.Summary.Yesterday.Freight/yTotal)*100).toFixed(1)});
            document.getElementById('yMiscCard').onclick = () => showDrilldown('category', {name:'Misc', amount:DATA.Summary.Yesterday.Miscellaneous, pct:((DATA.Summary.Yesterday.Miscellaneous/yTotal)*100).toFixed(1)});

            // Lists
            renderList('topCustomersMTD', DATA.TopCustomers.MTD);
            renderList('topProductsMTD', DATA.TopProducts.MTD, 'Item');
            renderList('topCustomersYesterday', DATA.TopCustomers.Yesterday);
            renderList('fullCustomerList', DATA.TopCustomers.MTD);
            renderList('fullProductList', DATA.TopProducts.MTD, 'Item');

            // Charts
            initCharts();
            initCashFlow();
        }

        function initCharts() {
            // Trend Chart - filter out zero days at the beginning
            const trendData = DATA.DailyTrend.filter((d,i,arr) => {
                // Find first non-zero day and include all days from there
                const firstNonZero = arr.findIndex(x => x.Total > 0);
                return i >= firstNonZero;
            });
            
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            charts.trend = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: trendData.map(d => new Date(d.Date).toLocaleDateString('en-US',{month:'short',day:'numeric'})),
                    datasets: [{
                        label: 'Total Sales',
                        data: trendData.map(d => d.Total),
                        borderColor: '#4ecdc4',
                        backgroundColor: 'rgba(78,205,196,0.1)',
                        fill: true,
                        tension: 0.4,
                        pointHoverRadius: 8,
                        pointHoverBackgroundColor: '#4ecdc4'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Total: ${fmt(context.raw)} (click for details)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', maxTicksLimit: 15 } },
                        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }
                    },
                    onClick: function(e, elements) {
                        if (elements.length > 0) {
                            const idx = elements[0].index;
                            const dayData = trendData[idx];
                            showDrilldown('daily', {date: dayData.Date, ...dayData});
                        }
                    }
                }
            });

            // Category Pie
            const pieCtx = document.getElementById('categoryPie').getContext('2d');
            charts.pie = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Product', 'Service', 'Freight', 'Misc'],
                    datasets: [{ data: [DATA.Summary.MTD.Product, DATA.Summary.MTD.Service, DATA.Summary.MTD.Freight, DATA.Summary.MTD.Miscellaneous], backgroundColor: ['#4ecdc4','#ff6b6b','#feca57','#a29bfe'], borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: '#98c1d9' } } } }
            });

            // AR Chart
            if (DATA.ARaging) {
                const arBucketInfo = [
                    {name:'Current', amount:DATA.ARaging.Current, desc:'Invoices not yet due'},
                    {name:'1-30 Days', amount:DATA.ARaging.Days1_30, desc:'Invoices 1-30 days past due'},
                    {name:'31-60 Days', amount:DATA.ARaging.Days31_60, desc:'Invoices 31-60 days past due'},
                    {name:'61-90 Days', amount:DATA.ARaging.Days61_90, desc:'Invoices 61-90 days past due'},
                    {name:'90+ Days', amount:DATA.ARaging.Days90Plus, desc:'Invoices over 90 days past due'}
                ];
                const arCtx = document.getElementById('arChart').getContext('2d');
                charts.ar = new Chart(arCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Current', '1-30', '31-60', '61-90', '90+'],
                        datasets: [{ data: [DATA.ARaging.Current, DATA.ARaging.Days1_30, DATA.ARaging.Days31_60, DATA.ARaging.Days61_90, DATA.ARaging.Days90Plus], backgroundColor: ['#06d6a0','#4ecdc4','#ffd166','#ff9f43','#ef476f'] }]
                    },
                    options: { 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: false } }, 
                        scales: { x: { grid: { display: false }, ticks: { color: '#98c1d9' } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } } },
                        onClick: function(e, elements) {
                            if (elements.length > 0) {
                                const idx = elements[0].index;
                                showDrilldown('ar-bucket', arBucketInfo[idx]);
                            }
                        }
                    }
                });
            }

            // Day of Week Chart
            const dowCtx = document.getElementById('dowChart').getContext('2d');
            const days = ['Monday','Tuesday','Wednesday','Thursday','Friday'];
            const dowData = DATA.DayOfWeekAverages ? days.map(d => DATA.DayOfWeekAverages[d] || 0) : days.map(() => DATA.Summary.MTDDailyAverage || 0);
            charts.dow = new Chart(dowCtx, {
                type: 'bar',
                data: {
                    labels: days.map(d => d.substring(0,3)),
                    datasets: [{ data: dowData, backgroundColor: '#4ecdc4' }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { color: '#98c1d9' } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } } } }
            });

            // Customer Bar Chart
            if (DATA.TopCustomers.MTD?.length) {
                const custCtx = document.getElementById('customerBarChart').getContext('2d');
                charts.cust = new Chart(custCtx, {
                    type: 'bar',
                    data: {
                        labels: DATA.TopCustomers.MTD.slice(0,15).map(c => c.Name.substring(0,25)),
                        datasets: [{ data: DATA.TopCustomers.MTD.slice(0,15).map(c => c.Amount), backgroundColor: '#4ecdc4' }]
                    },
                    options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, y: { grid: { display: false }, ticks: { color: '#98c1d9' } } } }
                });
            }

            // Product Bar Chart
            if (DATA.TopProducts.MTD?.length) {
                const prodCtx = document.getElementById('productBarChart').getContext('2d');
                charts.prod = new Chart(prodCtx, {
                    type: 'bar',
                    data: {
                        labels: DATA.TopProducts.MTD.slice(0,15).map(p => p.Item.substring(0,20)),
                        datasets: [{ data: DATA.TopProducts.MTD.slice(0,15).map(p => p.Amount), backgroundColor: '#feca57' }]
                    },
                    options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, y: { grid: { display: false }, ticks: { color: '#98c1d9' } } } }
                });
            }

            // Product Pie Chart (MTD category breakdown)
            const prodPieCtx = document.getElementById('productPieChart').getContext('2d');
            charts.prodPie = new Chart(prodPieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Product', 'Service', 'Freight', 'Miscellaneous'],
                    datasets: [{ 
                        data: [DATA.Summary.MTD.Product, DATA.Summary.MTD.Service, DATA.Summary.MTD.Freight, DATA.Summary.MTD.Miscellaneous], 
                        backgroundColor: ['#4ecdc4','#ff6b6b','#feca57','#a29bfe'], 
                        borderWidth: 0 
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { position: 'right', labels: { color: '#98c1d9', padding: 15 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a,b) => a+b, 0);
                                    const pct = ((context.raw / total) * 100).toFixed(1);
                                    return `${context.label}: ${fmt(context.raw)} (${pct}%)`;
                                }
                            }
                        }
                    } 
                }
            });
        }

        let salesChartsInit = false;
        function initSalesPage() {
            if (salesChartsInit || !DATA.AllTeam) return;
            salesChartsInit = true;
            
            const allTeamMTD = DATA.AllTeam?.MTD || [];
            const allTeamYesterday = DATA.AllTeam?.Yesterday || [];
            const salesMTD = DATA.Salesperson?.MTD || [];
            const salesYesterday = DATA.Salesperson?.Yesterday || [];
            const serviceTeamMTD = DATA.ServiceTeam?.MTD || [];
            const serviceTeamYesterday = DATA.ServiceTeam?.Yesterday || [];
            const fieldTechs = DATA.FieldTechnicians || [];
            
            // KPIs (use all team totals)
            const mtdTotal = allTeamMTD.reduce((s,p) => s + p.Amount, 0);
            const yTotal = allTeamYesterday.reduce((s,p) => s + p.Amount, 0);
            const invoiceCount = allTeamMTD.reduce((s,p) => s + (p.InvoiceCount || 0), 0);
            
            // Top performer = only Outside Sales reps
            const outsideSalesMTD = allTeamMTD.filter(p => p.Role === 'Outside Sales');
            const topPerformer = outsideSalesMTD[0]?.Name || '--';
            
            document.getElementById('spYesterdayTotal').textContent = fmt(yTotal);
            document.getElementById('spMTDTotal').textContent = fmt(mtdTotal);
            document.getElementById('spTopPerformer').textContent = topPerformer;
            document.getElementById('spInvoiceCount').textContent = invoiceCount;
            
            // Service-specific KPIs - use ship-to address data for states covered
            const svcTotal = DATA.Summary?.MTD?.Service || 0;  // Total service revenue from GL
            const svcTeamTotal = serviceTeamMTD.reduce((s,p) => s + (p.Amount || 0), 0);  // Service team's sales
            const svcInvoices = serviceTeamMTD.reduce((s,p) => s + (p.InvoiceCount || 0), 0);
            const svcAvg = svcInvoices > 0 ? svcTeamTotal / svcInvoices : 0;
            // Use shipping data for states covered (ship-to addresses in US)
            const shippingStats = DATA.ShippingStats || {};
            const statesCovered = shippingStats.MTDUSStates || shippingStats.TotalUSStates || 0;
            const topSvcTeam = serviceTeamMTD[0]?.Name || '--';
            
            document.getElementById('svcMTDTotal').textContent = fmt(svcTotal);
            document.getElementById('svcAvgTicket').textContent = fmt(svcAvg);
            document.getElementById('svcStates').textContent = statesCovered;
            document.getElementById('svcTopRep').textContent = topSvcTeam;
            
            // Lists
            renderSalespersonList('allTeamMTDList', allTeamMTD, true);
            renderSalespersonList('salespersonMTDList', salesMTD, true);
            renderSalespersonList('serviceRepMTDList', serviceTeamMTD, true, true);  // Show territory for service team
            renderSalespersonList('salespersonYesterdayList', allTeamYesterday, true);
            
            // Field Technicians List
            renderFieldTechList('fieldTechList', fieldTechs);
            
            // Field Tech KPIs
            const ftSummary = DATA.FieldTechSummary || {};
            document.getElementById('ftTotalTechs').textContent = ftSummary.TotalTechs || fieldTechs.length || 0;
            document.getElementById('ftApptsMTD').textContent = ftSummary.TotalAppointmentsMTD || 0;
            document.getElementById('ftStatesMTD').textContent = ftSummary.TotalStatesCovered || 0;
            document.getElementById('ftTopTech').textContent = ftSummary.TopPerformer || '--';
            
            // Service States Covered (from field tech data)
            renderServiceStatesFromTechs('serviceStatesCovered', fieldTechs);
            
            // All Team MTD Stacked Bar Chart
            if (allTeamMTD.length) {
                const allCtx = document.getElementById('allTeamBarChart').getContext('2d');
                charts.allTeam = new Chart(allCtx, {
                    type: 'bar',
                    data: {
                        labels: allTeamMTD.map(p => `${p.Name} (${p.Role || 'Team'})`),
                        datasets: [
                            { label: 'Product', data: allTeamMTD.map(p => p.ProductAmount || 0), backgroundColor: '#4ecdc4' },
                            { label: 'Service', data: allTeamMTD.map(p => p.ServiceAmount || 0), backgroundColor: '#ff6b6b' }
                        ]
                    },
                    options: { 
                        indexAxis: 'y', 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: true, position: 'top', labels: { color: '#98c1d9' } } }, 
                        scales: { 
                            x: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, 
                            y: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9', font: { size: 11 } } } 
                        } 
                    }
                });
            }
            
            // Sales Reps MTD Bar Chart
            if (salesMTD.length) {
                const spCtx = document.getElementById('salespersonBarChart').getContext('2d');
                charts.spMtd = new Chart(spCtx, {
                    type: 'bar',
                    data: {
                        labels: salesMTD.map(p => p.Name),
                        datasets: [
                            { label: 'Product', data: salesMTD.map(p => p.ProductAmount || 0), backgroundColor: '#4ecdc4' },
                            { label: 'Service', data: salesMTD.map(p => p.ServiceAmount || 0), backgroundColor: '#ff6b6b' }
                        ]
                    },
                    options: { 
                        indexAxis: 'y', 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: true, position: 'top', labels: { color: '#98c1d9' } } }, 
                        scales: { 
                            x: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, 
                            y: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9' } } 
                        } 
                    }
                });
            }
            
            // Service Team MTD Bar Chart
            if (serviceTeamMTD.length) {
                const svcCtx = document.getElementById('serviceRepBarChart').getContext('2d');
                charts.svcMtd = new Chart(svcCtx, {
                    type: 'bar',
                    data: {
                        labels: serviceTeamMTD.map(p => p.Name),
                        datasets: [
                            { label: 'Product', data: serviceTeamMTD.map(p => p.ProductAmount || 0), backgroundColor: '#4ecdc4' },
                            { label: 'Service', data: serviceTeamMTD.map(p => p.ServiceAmount || 0), backgroundColor: '#ff6b6b' }
                        ]
                    },
                    options: { 
                        indexAxis: 'y', 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: true, position: 'top', labels: { color: '#98c1d9' } } }, 
                        scales: { 
                            x: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, 
                            y: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9' } } 
                        } 
                    }
                });
            }
            
            // Yesterday Bar Chart
            if (allTeamYesterday.length) {
                const spYCtx = document.getElementById('salespersonYesterdayChart').getContext('2d');
                charts.spYesterday = new Chart(spYCtx, {
                    type: 'bar',
                    data: {
                        labels: allTeamYesterday.map(p => `${p.Name} (${p.Role || 'Team'})`),
                        datasets: [
                            { label: 'Product', data: allTeamYesterday.map(p => p.ProductAmount || 0), backgroundColor: '#4ecdc4' },
                            { label: 'Service', data: allTeamYesterday.map(p => p.ServiceAmount || 0), backgroundColor: '#ff6b6b' }
                        ]
                    },
                    options: { 
                        indexAxis: 'y', 
                        responsive: true, 
                        maintainAspectRatio: false, 
                        plugins: { legend: { display: true, position: 'top', labels: { color: '#98c1d9' } } }, 
                        scales: { 
                            x: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }, 
                            y: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9' } } 
                        } 
                    }
                });
            }
        }

        let arPageInit = false;
        function initARPage() {
            if (arPageInit || !DATA.ARaging) return;
            arPageInit = true;
            
            const ar = DATA.ARaging;
            const total = ar.Total || 0;
            const overdue = (ar.Days1_30 || 0) + (ar.Days31_60 || 0) + (ar.Days61_90 || 0) + (ar.Days90Plus || 0);
            
            // KPIs
            document.getElementById('arKpiTotal').textContent = fmt(total);
            document.getElementById('arKpiCurrent').textContent = fmt(ar.Current || 0);
            document.getElementById('arKpiOverdue').textContent = fmt(overdue);
            document.getElementById('arKpi90Plus').textContent = fmt(ar.Days90Plus || 0);
            
            // Add click handlers for AR KPIs
            document.getElementById('arKpiCurrentCard').onclick = () => showDrilldown('ar-bucket', {name:'Current', amount:ar.Current, desc:'Invoices not yet due - payment expected within terms'});
            document.getElementById('arKpiOverdueCard').onclick = () => showDrilldown('ar-bucket', {name:'Total Overdue', amount:overdue, desc:'All invoices past their due date - sum of 1-30, 31-60, 61-90, and 90+ day buckets'});
            document.getElementById('arKpi90PlusCard').onclick = () => showDrilldown('ar-bucket', {name:'90+ Days', amount:ar.Days90Plus, desc:'Invoices over 90 days past due - requires immediate attention'});
            
            // AR Aging Detail Grid
            const grid = document.getElementById('arAgingGrid');
            const buckets = [
                { name: 'Current (Not Due)', amount: ar.Current || 0, class: 'current' },
                { name: '1-30 Days Overdue', amount: ar.Days1_30 || 0, class: 'days30' },
                { name: '31-60 Days Overdue', amount: ar.Days31_60 || 0, class: 'days60' },
                { name: '61-90 Days Overdue', amount: ar.Days61_90 || 0, class: 'days90' },
                { name: '90+ Days Overdue', amount: ar.Days90Plus || 0, class: 'over90' },
                { name: 'Total', amount: total, class: 'total' }
            ];
            
            grid.innerHTML = `<div class="ar-detail-row header"><span>Bucket</span><span>Amount</span><span>% of Total</span></div>` +
                buckets.map(b => {
                    const pct = total > 0 ? ((b.amount / total) * 100).toFixed(1) : 0;
                    return `<div class="ar-detail-row ${b.class}"><span>${b.name}</span><span>${fmt(b.amount)}</span><span>${pct}%</span></div>`;
                }).join('');
            
            // AR Aging Bar Chart
            const arCtx = document.getElementById('arAgingDetailChart').getContext('2d');
            charts.arDetail = new Chart(arCtx, {
                type: 'bar',
                data: {
                    labels: ['Current', '1-30 Days', '31-60 Days', '61-90 Days', '90+ Days'],
                    datasets: [{
                        label: 'AR Balance',
                        data: [ar.Current || 0, ar.Days1_30 || 0, ar.Days31_60 || 0, ar.Days61_90 || 0, ar.Days90Plus || 0],
                        backgroundColor: ['#06d6a0', '#4ecdc4', '#ffd166', '#ff9f43', '#ef476f']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { color: '#98c1d9' } },
                        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }
                    }
                }
            });
            
            // AR Aging Pie Chart
            const pieCtx = document.getElementById('arAgingPieChart').getContext('2d');
            charts.arPie = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Current', '1-30 Days', '31-60 Days', '61-90 Days', '90+ Days'],
                    datasets: [{
                        data: [ar.Current || 0, ar.Days1_30 || 0, ar.Days31_60 || 0, ar.Days61_90 || 0, ar.Days90Plus || 0],
                        backgroundColor: ['#06d6a0', '#4ecdc4', '#ffd166', '#ff9f43', '#ef476f'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { color: '#98c1d9', padding: 12 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const pct = total > 0 ? ((context.raw / total) * 100).toFixed(1) : 0;
                                    return `${context.label}: ${fmt(context.raw)} (${pct}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Top Customers by AR (using customer data if available, otherwise show note)
            const arTopList = document.getElementById('arTopCustomers');
            if (DATA.TopCustomers?.MTD?.length) {
                // Use customer list as proxy - actual AR by customer would need more data
                arTopList.innerHTML = `<div style="padding:15px;color:var(--text-secondary);font-size:13px;background:rgba(255,255,255,0.03);border-radius:8px;margin-bottom:10px;">
                    <strong>Note:</strong> Showing top customers by MTD sales. Customer-level AR aging requires additional data integration.
                </div>` + DATA.TopCustomers.MTD.slice(0,20).map((c, i) => {
                    const rank = i < 3 ? ['gold', 'silver', 'bronze'][i] : '';
                    return `<div class="top-item"><div class="rank ${rank}">${i + 1}</div><div class="name" title="${c.Name}">${c.Name.substring(0, 35)}</div><div class="amount">${fmt(c.Amount)}</div></div>`;
                }).join('');
            } else {
                arTopList.innerHTML = '<div style="padding:20px;text-align:center;color:var(--text-secondary)">Customer AR data requires additional integration</div>';
            }
        }

        let pnlPageInit = false;
        function initPnLPage() {
            if (pnlPageInit || !DATA.Summary) return;
            pnlPageInit = true;
            
            const mtd = DATA.Summary.MTD;
            const total = mtd.Total || 0;
            const product = mtd.Product || 0;
            const service = mtd.Service || 0;
            const freight = mtd.Freight || 0;
            const misc = mtd.Miscellaneous || 0;
            const other = freight + misc;
            
            // KPIs
            document.getElementById('pnlRevenue').textContent = fmt(total);
            document.getElementById('pnlProductRev').textContent = fmt(product);
            document.getElementById('pnlServiceRev').textContent = fmt(service);
            document.getElementById('pnlOtherRev').textContent = fmt(other);
            
            // Add click handlers for P&L categories
            document.getElementById('pnlProductCard').onclick = () => showDrilldown('category', {name:'Product', amount:product, pct:((product/total)*100).toFixed(1)});
            document.getElementById('pnlServiceCard').onclick = () => showDrilldown('category', {name:'Service', amount:service, pct:((service/total)*100).toFixed(1)});
            document.getElementById('pnlOtherCard').onclick = () => showDrilldown('category', {name:'Freight', amount:other, pct:((other/total)*100).toFixed(1)});
            
            // P&L Grid
            document.querySelector('#pnlProductRow .amount').textContent = fmt(product);
            document.querySelector('#pnlServiceRow .amount').textContent = fmt(service);
            document.querySelector('#pnlFreightRow .amount').textContent = fmt(freight);
            document.querySelector('#pnlMiscRow .amount').textContent = fmt(misc);
            document.querySelector('#pnlTotalRow .amount').innerHTML = `<strong>${fmt(total)}</strong>`;
            
            // Category Bar Chart
            const catCtx = document.getElementById('pnlCategoryChart').getContext('2d');
            charts.pnlCat = new Chart(catCtx, {
                type: 'bar',
                data: {
                    labels: ['Product Sales', 'Service Sales', 'Freight', 'Miscellaneous'],
                    datasets: [{
                        label: 'MTD Revenue',
                        data: [product, service, freight, misc],
                        backgroundColor: ['#4ecdc4', '#ff6b6b', '#feca57', '#a29bfe']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { color: '#98c1d9' } },
                        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }
                    }
                }
            });
            
            // Mix Pie Chart
            const mixCtx = document.getElementById('pnlMixPieChart').getContext('2d');
            charts.pnlMix = new Chart(mixCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Product', 'Service', 'Freight', 'Miscellaneous'],
                    datasets: [{
                        data: [product, service, freight, misc],
                        backgroundColor: ['#4ecdc4', '#ff6b6b', '#feca57', '#a29bfe'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { color: '#98c1d9', padding: 12 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const pct = total > 0 ? ((context.raw / total) * 100).toFixed(1) : 0;
                                    return `${context.label}: ${fmt(context.raw)} (${pct}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Monthly Trend Chart (using daily trend data, grouped by month)
            const dailyData = DATA.DailyTrend || [];
            const monthlyData = {};
            dailyData.forEach(d => {
                const month = d.Date.substring(0, 7); // YYYY-MM
                if (!monthlyData[month]) {
                    monthlyData[month] = { Product: 0, Service: 0, Freight: 0, Misc: 0, Total: 0 };
                }
                monthlyData[month].Product += d.Product || 0;
                monthlyData[month].Service += d.Service || 0;
                monthlyData[month].Freight += d.Freight || 0;
                monthlyData[month].Misc += d.Miscellaneous || 0;
                monthlyData[month].Total += d.Total || 0;
            });
            
            const months = Object.keys(monthlyData).sort();
            const trendCtx = document.getElementById('pnlMonthlyTrendChart').getContext('2d');
            charts.pnlTrend = new Chart(trendCtx, {
                type: 'bar',
                data: {
                    labels: months.map(m => {
                        const [y, mo] = m.split('-');
                        return new Date(y, parseInt(mo) - 1).toLocaleDateString('en-US', { month: 'short', year: '2-digit' });
                    }),
                    datasets: [
                        { label: 'Product', data: months.map(m => monthlyData[m].Product), backgroundColor: '#4ecdc4' },
                        { label: 'Service', data: months.map(m => monthlyData[m].Service), backgroundColor: '#ff6b6b' },
                        { label: 'Freight', data: months.map(m => monthlyData[m].Freight), backgroundColor: '#feca57' },
                        { label: 'Misc', data: months.map(m => monthlyData[m].Misc), backgroundColor: '#a29bfe' }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#98c1d9' } } },
                    scales: {
                        x: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9' } },
                        y: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }
                    }
                }
            });
        }

        function initCashFlow() {
            if (!DATA.CashFlowPrediction?.length) return;

            const cf = DATA.CashFlowPrediction;
            document.getElementById('cfThisWeek').textContent = fmt(cf[0]?.Total);
            document.getElementById('cfNextWeek').textContent = fmt(cf[1]?.Total);
            document.getElementById('cf6Week').textContent = fmt(cf.reduce((s,w) => s + w.Total, 0));
            document.getElementById('cfARDue').textContent = fmt(cf.reduce((s,w) => s + (w.ARDue||0), 0));
            
            // Add click handlers for cash flow KPIs
            if (cf[0]) document.getElementById('cfThisWeekCard').onclick = () => showDrilldown('cashflow-week', cf[0]);
            if (cf[1]) document.getElementById('cfNextWeekCard').onclick = () => showDrilldown('cashflow-week', cf[1]);

            // Week breakdown
            const wb = document.getElementById('weekBreakdown');
            wb.innerHTML = cf.map((w, idx) => {
                const confClass = w.Confidence >= 80 ? 'high' : w.Confidence >= 60 ? 'medium' : 'low';
                const weekData = JSON.stringify(w).replace(/"/g, '&quot;');
                return `
                    <div class="cash-flow-week clickable" onclick="showDrilldown('cashflow-week', ${weekData})" style="cursor:pointer;">
                        <div class="week-header">
                            <div><span class="week-label">${w.Week}</span></div>
                            <div class="week-total">${fmt(w.Total)}</div>
                            <span class="confidence ${confClass}">${w.Confidence}% confidence</span>
                        </div>
                        <div class="day-breakdown">
                            ${w.DayBreakdown.map(d => `
                                <div class="day ${d.Type.toLowerCase()}">
                                    <div class="day-name">${d.DayOfWeek.substring(0,3)}</div>
                                    <div class="day-amount">${fmt(d.Amount)}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            // Cash Flow Chart
            const cfCtx = document.getElementById('cashFlowChart').getContext('2d');
            charts.cf = new Chart(cfCtx, {
                type: 'bar',
                data: {
                    labels: cf.map(w => w.Week.replace('Week of ','')),
                    datasets: [
                        { label: 'Actual', data: cf.map(w => w.Actual), backgroundColor: '#06d6a0' },
                        { label: 'Predicted', data: cf.map(w => w.Predicted), backgroundColor: 'rgba(255,209,102,0.7)' }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#98c1d9' } } },
                    scales: {
                        x: { stacked: true, grid: { display: false }, ticks: { color: '#98c1d9' } },
                        y: { stacked: true, grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } }
                    }
                }
            });

            // DOW Avg Chart
            const dowCtx = document.getElementById('dowAvgChart').getContext('2d');
            const days = ['Monday','Tuesday','Wednesday','Thursday','Friday'];
            const dowData = DATA.DayOfWeekAverages ? days.map(d => DATA.DayOfWeekAverages[d] || 0) : days.map(() => DATA.Summary.MTDDailyAverage || 0);
            charts.dowAvg = new Chart(dowCtx, {
                type: 'bar',
                data: {
                    labels: days,
                    datasets: [{ label: 'Historical Average', data: dowData, backgroundColor: '#4ecdc4' }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { color: '#98c1d9' } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9', callback: v => fmtK(v) } } } }
            });
        }

        let map = null;
        function initMap() {
            if (map || !DATA.ShippingHeatMap?.length) return;
            map = L.map('shippingMap').setView([39.8, -98.6], 4);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);
            
            const stateCounts = {};
            DATA.ShippingHeatMap.forEach(loc => {
                const coords = stateCoords[loc.State];
                if (coords) {
                    stateCounts[loc.State] = (stateCounts[loc.State] || 0) + loc.Count;
                    L.circleMarker([coords[0] + (Math.random()-0.5)*2, coords[1] + (Math.random()-0.5)*2], {
                        radius: Math.min(Math.max(loc.Count * 2, 4), 25),
                        fillColor: '#4ecdc4',
                        color: '#4ecdc4',
                        weight: 1,
                        opacity: 0.8,
                        fillOpacity: 0.4
                    }).addTo(map).bindPopup(`<b>${loc.City}, ${loc.State}</b><br>${loc.Count} shipments`);
                }
            });

            // Top locations list
            renderList('topLocations', DATA.ShippingHeatMap.slice(0,20).map(l => ({Name: `${l.City}, ${l.State}`, Amount: l.Count})));
            document.querySelectorAll('#topLocations .amount').forEach(el => el.textContent = el.textContent.replace('$','') + ' shipments');

            // State chart
            const sorted = Object.entries(stateCounts).sort((a,b) => b[1]-a[1]).slice(0,15);
            const stateCtx = document.getElementById('stateChart').getContext('2d');
            charts.state = new Chart(stateCtx, {
                type: 'bar',
                data: {
                    labels: sorted.map(s => s[0]),
                    datasets: [{ data: sorted.map(s => s[1]), backgroundColor: '#4ecdc4' }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { color: '#98c1d9' } }, y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#98c1d9' } } } }
            });

            // Field Service Tech Territory Map (from Salesforce data)
            const svcMap = L.map('serviceTechMap').setView([39.8, -98.6], 4);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(svcMap);
            
            const fieldTechs = DATA.FieldTechnicians || [];
            // Filter to top 10 techs by appointments for cleaner map
            const topTechs = [...fieldTechs].sort((a,b) => (b.AppointmentsMTD || 0) - (a.AppointmentsMTD || 0)).slice(0, 10);
            const techColors = ['#ff6b6b', '#feca57', '#a29bfe', '#00d2d3', '#ff9ff3', '#54a0ff', '#5f27cd', '#00b894', '#fdcb6e', '#e17055'];
            let legendHtml = '';
            
            // Build state -> tech mapping for markers
            const stateMarkers = {};
            topTechs.forEach((tech, idx) => {
                const color = techColors[idx % techColors.length];
                const statesDetail = tech.StatesDetail || [];
                
                statesDetail.forEach(sd => {
                    const stateName = sd.State;
                    const stateAbbr = getStateAbbr(stateName);
                    if (stateAbbr && stateCoords[stateAbbr]) {
                        if (!stateMarkers[stateAbbr]) stateMarkers[stateAbbr] = { name: stateName, techs: [] };
                        stateMarkers[stateAbbr].techs.push({ tech: tech.Name, count: sd.Count, color: color, isLead: tech.IsLead });
                    }
                });
                
                const stateCount = tech.StateCount || 0;
                const leadIcon = tech.IsLead ? 'â­ ' : '';
                legendHtml += `<div style="display:flex;align-items:center;gap:5px;">
                    <div style="width:12px;height:12px;border-radius:50%;background:${color};"></div>
                    <span>${leadIcon}${tech.Name}: ${tech.AppointmentsMTD || 0} appts, ${stateCount} states</span>
                </div>`;
            });
            
            // Add markers to map - size based on appointment count
            Object.entries(stateMarkers).forEach(([stateAbbr, data]) => {
                const coords = stateCoords[stateAbbr];
                if (!coords) return;
                
                const techs = data.techs;
                const totalAppts = techs.reduce((s, t) => s + t.count, 0);
                const primaryTech = techs.sort((a,b) => b.count - a.count)[0];
                const radius = Math.min(25, 8 + totalAppts * 0.5);
                
                const popupContent = `<b>${data.name || stateAbbr}</b><br><b>${totalAppts} appointments</b><br>` + 
                    techs.map(t => `${t.tech}: ${t.count}`).join('<br>');
                
                L.circleMarker([coords[0], coords[1]], {
                    radius: radius,
                    fillColor: primaryTech.color,
                    color: primaryTech.color,
                    weight: 2,
                    opacity: 0.9,
                    fillOpacity: 0.5
                }).addTo(svcMap).bindPopup(popupContent);
            });
            
            document.getElementById('serviceTechLegend').innerHTML = legendHtml || '<span style="color:var(--text-secondary)">No field tech data available</span>';
        }

        loadData();

        // ========== DRILL-DOWN FUNCTIONALITY ==========
        function closeDrilldown(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('drilldownOverlay').classList.remove('active');
        }

        function showDrilldown(type, context) {
            const title = document.getElementById('drilldownTitle');
            const body = document.getElementById('drilldownBody');
            let html = '';

            switch(type) {
                case 'yesterday':
                    html = buildSalesDrilldown('Yesterday\'s Sales', DATA.Summary.Yesterday, DATA.TopCustomers.Yesterday, DATA.AllTeam?.Yesterday);
                    title.textContent = `Yesterday (${DATA.Period.Yesterday})`;
                    break;
                case 'mtd':
                    html = buildSalesDrilldown('Month-to-Date Sales', DATA.Summary.MTD, DATA.TopCustomers.MTD, DATA.AllTeam?.MTD);
                    title.textContent = `MTD Sales (${DATA.Period.MonthStart} to ${DATA.Period.Yesterday})`;
                    break;
                case 'ytd':
                    html = buildSalesDrilldown('Year-to-Date Sales', DATA.Summary.YTD, DATA.TopCustomers.MTD);
                    title.textContent = `YTD Sales (${DATA.Period.YearStart} to ${DATA.Period.Yesterday})`;
                    break;
                case 'ar':
                    html = buildARDrilldown();
                    title.textContent = 'AR Aging Breakdown';
                    break;
                case 'ar-bucket':
                    html = buildARBucketDrilldown(context);
                    title.textContent = `AR Aging: ${context.name}`;
                    break;
                case 'category':
                    html = buildCategoryDrilldown(context);
                    title.textContent = `${context.name} Sales`;
                    break;
                case 'customer':
                    html = buildCustomerDrilldown(context);
                    title.textContent = context.name;
                    break;
                case 'product':
                    html = buildProductDrilldown(context);
                    title.textContent = context.item;
                    break;
                case 'cashflow-week':
                    html = buildCashFlowWeekDrilldown(context);
                    title.textContent = context.week;
                    break;
                case 'salesperson':
                    html = buildSalespersonDrilldown(context);
                    title.textContent = context.name;
                    break;
                case 'daily':
                    html = buildDailyDrilldown(context);
                    title.textContent = `Daily Sales: ${context.date}`;
                    break;
                default:
                    html = '<p>No details available</p>';
            }

            body.innerHTML = html;
            document.getElementById('drilldownOverlay').classList.add('active');
        }

        function buildSalesDrilldown(label, summary, customers, team) {
            const total = summary?.Total || 0;
            let html = `<div class="drilldown-total">${fmt(total)}</div>`;
            
            // Category breakdown
            html += `<div class="drilldown-section">
                <h4>ðŸ“Š Breakdown by Category</h4>
                <div class="drilldown-row product">
                    <span class="label">Product Sales (401000)</span>
                    <span class="value">${fmt(summary?.Product || 0)} <span class="drilldown-pct">${total > 0 ? ((summary?.Product / total) * 100).toFixed(1) : 0}%</span></span>
                </div>
                <div class="drilldown-row service">
                    <span class="label">Service Sales (402000)</span>
                    <span class="value">${fmt(summary?.Service || 0)} <span class="drilldown-pct">${total > 0 ? ((summary?.Service / total) * 100).toFixed(1) : 0}%</span></span>
                </div>
                <div class="drilldown-row freight">
                    <span class="label">Freight Revenue (495400)</span>
                    <span class="value">${fmt(summary?.Freight || 0)} <span class="drilldown-pct">${total > 0 ? ((summary?.Freight / total) * 100).toFixed(1) : 0}%</span></span>
                </div>
                <div class="drilldown-row misc">
                    <span class="label">Miscellaneous (495000)</span>
                    <span class="value">${fmt(summary?.Miscellaneous || 0)} <span class="drilldown-pct">${total > 0 ? ((summary?.Miscellaneous / total) * 100).toFixed(1) : 0}%</span></span>
                </div>
                <div class="drilldown-row total">
                    <span class="label"><strong>Total</strong></span>
                    <span class="value"><strong>${fmt(total)}</strong></span>
                </div>
            </div>`;

            // Team breakdown if available
            if (team && team.length > 0) {
                html += `<div class="drilldown-section">
                    <h4>ðŸ‘¥ By Team Member</h4>
                    ${team.slice(0, 10).map(t => `
                        <div class="drilldown-item" onclick="showDrilldown('salesperson', ${JSON.stringify(t).replace(/"/g, '&quot;')})" style="cursor:pointer;">
                            <span class="name">${t.Name} <span style="color:var(--text-secondary);font-size:11px;">(${t.Role || 'Team'})</span></span>
                            <span class="amount">${fmt(t.Amount)}</span>
                        </div>
                    `).join('')}
                </div>`;
            }

            // Top customers
            if (customers && customers.length > 0) {
                html += `<div class="drilldown-section">
                    <h4>ðŸ¢ Top Customers</h4>
                    ${customers.slice(0, 10).map(c => `
                        <div class="drilldown-item" onclick="showDrilldown('customer', ${JSON.stringify(c).replace(/"/g, '&quot;')})" style="cursor:pointer;">
                            <span class="name">${c.Name}</span>
                            <span class="amount">${fmt(c.Amount)}</span>
                        </div>
                    `).join('')}
                </div>`;
            }

            return html;
        }

        function buildARDrilldown() {
            const ar = DATA.ARaging || {};
            const total = ar.Total || 0;
            const overdue = (ar.Days1_30 || 0) + (ar.Days31_60 || 0) + (ar.Days61_90 || 0) + (ar.Days90Plus || 0);
            
            let html = `<div class="drilldown-total">${fmt(total)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ“… Aging Buckets</h4>
                <div class="drilldown-row" style="cursor:pointer;" onclick="showDrilldown('ar-bucket', {name:'Current', amount:${ar.Current || 0}, desc:'Invoices not yet due'})">
                    <span class="label">Current (Not Due)</span>
                    <span class="value" style="color:var(--success);">${fmt(ar.Current || 0)} <span class="drilldown-pct">${((ar.Current / total) * 100).toFixed(1)}%</span></span>
                </div>
                <div class="drilldown-row" style="cursor:pointer;" onclick="showDrilldown('ar-bucket', {name:'1-30 Days', amount:${ar.Days1_30 || 0}, desc:'Invoices 1-30 days past due'})">
                    <span class="label">1-30 Days Overdue</span>
                    <span class="value" style="color:#4ecdc4;">${fmt(ar.Days1_30 || 0)} <span class="drilldown-pct">${((ar.Days1_30 / total) * 100).toFixed(1)}%</span></span>
                </div>
                <div class="drilldown-row" style="cursor:pointer;" onclick="showDrilldown('ar-bucket', {name:'31-60 Days', amount:${ar.Days31_60 || 0}, desc:'Invoices 31-60 days past due'})">
                    <span class="label">31-60 Days Overdue</span>
                    <span class="value" style="color:var(--warning);">${fmt(ar.Days31_60 || 0)} <span class="drilldown-pct">${((ar.Days31_60 / total) * 100).toFixed(1)}%</span></span>
                </div>
                <div class="drilldown-row" style="cursor:pointer;" onclick="showDrilldown('ar-bucket', {name:'61-90 Days', amount:${ar.Days61_90 || 0}, desc:'Invoices 61-90 days past due'})">
                    <span class="label">61-90 Days Overdue</span>
                    <span class="value" style="color:#ff9f43;">${fmt(ar.Days61_90 || 0)} <span class="drilldown-pct">${((ar.Days61_90 / total) * 100).toFixed(1)}%</span></span>
                </div>
                <div class="drilldown-row" style="cursor:pointer;" onclick="showDrilldown('ar-bucket', {name:'90+ Days', amount:${ar.Days90Plus || 0}, desc:'Invoices over 90 days past due - requires attention'})">
                    <span class="label">90+ Days Overdue</span>
                    <span class="value" style="color:var(--danger);">${fmt(ar.Days90Plus || 0)} <span class="drilldown-pct">${((ar.Days90Plus / total) * 100).toFixed(1)}%</span></span>
                </div>
            </div>`;

            html += `<div class="drilldown-section">
                <h4>ðŸ“ˆ Summary</h4>
                <div class="drilldown-row">
                    <span class="label">Total Overdue</span>
                    <span class="value" style="color:var(--warning);">${fmt(overdue)} <span class="drilldown-pct">${((overdue / total) * 100).toFixed(1)}%</span></span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Current (Healthy)</span>
                    <span class="value" style="color:var(--success);">${fmt(ar.Current || 0)} <span class="drilldown-pct">${((ar.Current / total) * 100).toFixed(1)}%</span></span>
                </div>
            </div>`;

            return html;
        }

        function buildARBucketDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.amount)}</div>`;
            html += `<div class="drilldown-section">
                <h4>â„¹ï¸ About This Bucket</h4>
                <p style="color:var(--text-secondary);margin:0;">${context.desc}</p>
            </div>`;
            
            // Show collection probability info
            const probabilities = {
                'Current': { rate: '95%+', action: 'Normal follow-up' },
                '1-30 Days': { rate: '85-95%', action: 'Send reminder notice' },
                '31-60 Days': { rate: '70-85%', action: 'Phone call recommended' },
                '61-90 Days': { rate: '50-70%', action: 'Escalate to management' },
                '90+ Days': { rate: '<50%', action: 'Consider collection agency or write-off review' }
            };
            const prob = probabilities[context.name] || {};
            
            html += `<div class="drilldown-section">
                <h4>ðŸ’° Collection Guidance</h4>
                <div class="drilldown-row">
                    <span class="label">Expected Collection Rate</span>
                    <span class="value">${prob.rate || 'N/A'}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Recommended Action</span>
                    <span class="value" style="font-size:13px;">${prob.action || 'Standard process'}</span>
                </div>
            </div>`;

            html += `<div class="drilldown-section" style="background:rgba(255,255,255,0.02);border:1px dashed rgba(255,255,255,0.1);">
                <p style="color:var(--text-secondary);margin:0;font-size:13px;">
                    <strong>Note:</strong> Customer-level AR details require Birst or SyteLine AR aging report integration. 
                    Current totals are from the Birst Financial Dashboard.
                </p>
            </div>`;

            return html;
        }

        function buildCategoryDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.amount)}</div>`;
            
            const categoryInfo = {
                'Product': { 
                    color: '#4ecdc4', 
                    account: '401000', 
                    desc: 'Physical goods sold - gas sensors, detectors, calibration equipment, etc.',
                    icon: 'ðŸ“¦'
                },
                'Service': { 
                    color: '#ff6b6b', 
                    account: '402000', 
                    desc: 'Labor and service revenue - on-site calibrations, repairs, installations.',
                    icon: 'ðŸ”§'
                },
                'Freight': { 
                    color: '#feca57', 
                    account: '495400', 
                    desc: 'Shipping and handling charges billed to customers.',
                    icon: 'ðŸšš'
                },
                'Misc': { 
                    color: '#a29bfe', 
                    account: '495000', 
                    desc: 'Miscellaneous revenue - rentals, training, other non-standard items.',
                    icon: 'ðŸ“‹'
                }
            };
            const info = categoryInfo[context.name] || {};

            html += `<div class="drilldown-section">
                <h4>${info.icon || 'ðŸ“Š'} Category Details</h4>
                <div class="drilldown-row">
                    <span class="label">GL Account</span>
                    <span class="value">${info.account || 'Various'}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Description</span>
                    <span class="value" style="font-size:13px;text-align:right;max-width:60%;">${info.desc || 'Revenue category'}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">% of Total</span>
                    <span class="value">${context.pct}%</span>
                </div>
            </div>`;

            // Show top products in this category if available
            if (context.name === 'Product' && DATA.TopProducts?.MTD) {
                html += `<div class="drilldown-section">
                    <h4>ðŸ† Top Items</h4>
                    ${DATA.TopProducts.MTD.slice(0, 8).map(p => `
                        <div class="drilldown-item">
                            <span class="name" title="${p.Description || ''}">${p.Item}</span>
                            <span class="amount">${fmt(p.Amount)}</span>
                        </div>
                    `).join('')}
                </div>`;
            }

            return html;
        }

        function buildCustomerDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.Amount)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ¢ Customer Information</h4>
                <div class="drilldown-row">
                    <span class="label">Customer Name</span>
                    <span class="value" style="font-size:13px;">${context.Name}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Period Total</span>
                    <span class="value">${fmt(context.Amount)}</span>
                </div>
            </div>`;

            html += `<div class="drilldown-section" style="background:rgba(255,255,255,0.02);border:1px dashed rgba(255,255,255,0.1);">
                <p style="color:var(--text-secondary);margin:0;font-size:13px;">
                    <strong>Note:</strong> Detailed invoice/order history requires SyteLine customer lookup integration.
                    This shows aggregate sales from GL ledger data.
                </p>
            </div>`;

            return html;
        }

        function buildProductDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.Amount)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ“¦ Product Information</h4>
                <div class="drilldown-row">
                    <span class="label">Item Number</span>
                    <span class="value">${context.Item}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Description</span>
                    <span class="value" style="font-size:12px;text-align:right;max-width:60%;">${context.Description || 'No description'}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">MTD Revenue</span>
                    <span class="value">${fmt(context.Amount)}</span>
                </div>
            </div>`;

            return html;
        }

        function buildCashFlowWeekDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.Total)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ“… Daily Breakdown</h4>
                ${context.DayBreakdown.map(d => `
                    <div class="drilldown-row">
                        <span class="label">${d.DayOfWeek} (${d.Date}) <span style="color:${d.Type === 'Actual' ? 'var(--success)' : 'var(--warning)'};">[${d.Type}]</span></span>
                        <span class="value">${fmt(d.Amount)}</span>
                    </div>
                `).join('')}
                <div class="drilldown-row total">
                    <span class="label"><strong>Week Total</strong></span>
                    <span class="value"><strong>${fmt(context.Total)}</strong></span>
                </div>
            </div>`;

            if (context.Sources) {
                html += `<div class="drilldown-section">
                    <h4>ðŸ’° Expected Collection Sources</h4>
                    <div class="drilldown-row">
                        <span class="label">From Current AR</span>
                        <span class="value" style="color:var(--success);">${fmt(context.Sources.FromCurrent || 0)}</span>
                    </div>
                    <div class="drilldown-row">
                        <span class="label">From 1-30 Day AR</span>
                        <span class="value" style="color:#4ecdc4;">${fmt(context.Sources.From1_30 || 0)}</span>
                    </div>
                    <div class="drilldown-row">
                        <span class="label">From 31-60 Day AR</span>
                        <span class="value" style="color:var(--warning);">${fmt(context.Sources.From31_60 || 0)}</span>
                    </div>
                    <div class="drilldown-row">
                        <span class="label">From 61-90 Day AR</span>
                        <span class="value" style="color:#ff9f43;">${fmt(context.Sources.From61_90 || 0)}</span>
                    </div>
                    <div class="drilldown-row">
                        <span class="label">From 90+ Day AR</span>
                        <span class="value" style="color:var(--danger);">${fmt(context.Sources.From90Plus || 0)}</span>
                    </div>
                </div>`;
            }

            html += `<div class="drilldown-section">
                <h4>ðŸ“Š Confidence</h4>
                <div class="drilldown-row">
                    <span class="label">Prediction Confidence</span>
                    <span class="value" style="color:${context.Confidence >= 80 ? 'var(--success)' : context.Confidence >= 50 ? 'var(--warning)' : 'var(--danger)'};">${context.Confidence}%</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Actual vs Predicted</span>
                    <span class="value">${fmt(context.Actual || 0)} actual / ${fmt(context.Predicted || 0)} predicted</span>
                </div>
            </div>`;

            return html;
        }

        function buildSalespersonDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.Amount)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ‘¤ Team Member Details</h4>
                <div class="drilldown-row">
                    <span class="label">Name</span>
                    <span class="value">${context.Name}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Role</span>
                    <span class="value">${context.Role || 'Team Member'}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Username</span>
                    <span class="value">${context.Username || 'N/A'}</span>
                </div>
            </div>`;

            html += `<div class="drilldown-section">
                <h4>ðŸ“Š Sales Breakdown</h4>
                <div class="drilldown-row product">
                    <span class="label">Product Sales</span>
                    <span class="value">${fmt(context.ProductAmount || 0)}</span>
                </div>
                <div class="drilldown-row service">
                    <span class="label">Service Sales</span>
                    <span class="value">${fmt(context.ServiceAmount || 0)}</span>
                </div>
                <div class="drilldown-row total">
                    <span class="label"><strong>Total</strong></span>
                    <span class="value"><strong>${fmt(context.Amount)}</strong></span>
                </div>
            </div>`;

            if (context.StateCount || context.CityCount) {
                html += `<div class="drilldown-section">
                    <h4>ðŸ—ºï¸ Territory Coverage</h4>
                    <div class="drilldown-row">
                        <span class="label">States Covered</span>
                        <span class="value">${context.StateCount || 0}</span>
                    </div>
                    <div class="drilldown-row">
                        <span class="label">Locations Served</span>
                        <span class="value">${context.CityCount || 0}</span>
                    </div>
                    ${context.States ? `<div class="drilldown-row">
                        <span class="label">States</span>
                        <span class="value" style="font-size:11px;max-width:60%;text-align:right;">${context.States}</span>
                    </div>` : ''}
                </div>`;
            }

            return html;
        }

        function buildDailyDrilldown(context) {
            let html = `<div class="drilldown-total">${fmt(context.Total)}</div>`;
            
            html += `<div class="drilldown-section">
                <h4>ðŸ“Š Category Breakdown</h4>
                <div class="drilldown-row product">
                    <span class="label">Product Sales</span>
                    <span class="value">${fmt(context.Product || 0)}</span>
                </div>
                <div class="drilldown-row service">
                    <span class="label">Service Sales</span>
                    <span class="value">${fmt(context.Service || 0)}</span>
                </div>
                <div class="drilldown-row freight">
                    <span class="label">Freight</span>
                    <span class="value">${fmt(context.Freight || 0)}</span>
                </div>
                <div class="drilldown-row misc">
                    <span class="label">Miscellaneous</span>
                    <span class="value">${fmt(context.Miscellaneous || 0)}</span>
                </div>
                <div class="drilldown-row total">
                    <span class="label"><strong>Total</strong></span>
                    <span class="value"><strong>${fmt(context.Total)}</strong></span>
                </div>
            </div>`;

            html += `<div class="drilldown-section">
                <h4>ðŸ“… Date Info</h4>
                <div class="drilldown-row">
                    <span class="label">Day of Week</span>
                    <span class="value">${context.DayOfWeek}</span>
                </div>
                <div class="drilldown-row">
                    <span class="label">Date</span>
                    <span class="value">${context.Date}</span>
                </div>
            </div>`;

            return html;
        }

        // Close on escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') closeDrilldown();
        });
    </script>
</body>
</html>
